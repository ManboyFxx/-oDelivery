import{r as a,j as e,X as v,d as h}from"./app-D2VljvTw.js";import{t as i}from"./index-CzcrtSLM.js";function S({isOpen:j,onClose:s,onLogin:d,slug:u}){const[m,p]=a.useState("phone"),[l,c]=a.useState(""),[f,x]=a.useState(""),[o,n]=a.useState(!1);a.useEffect(()=>{if(!localStorage.getItem("device_fingerprint")){const r=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"device-"+Math.random().toString(36).substring(2)+Date.now().toString(36);localStorage.setItem("device_fingerprint",r)}},[]);const g=async r=>{r.preventDefault(),n(!0);try{const t=await h.post("/customer/check-phone",{phone:l,tenant_slug:u,device_fingerprint:localStorage.getItem("device_fingerprint")||"unknown-device"});t.data.exists?(d(t.data.customer),s(),c(""),i.success(`Bem-vindo de volta, ${t.data.customer.name}!`)):p("name")}catch(t){console.error("Error checking phone:",t),i.error("Erro ao verificar telefone. Tente novamente.")}finally{n(!1)}},b=async r=>{r.preventDefault(),n(!0);try{const t=await h.post("/customer/complete-registration",{phone:l,name:f,tenant_slug:u});d(t.data.customer),s(),c(""),x(""),p("phone"),i.success("Cadastro realizado com sucesso!")}catch(t){console.error("Error completing registration:",t);const y=t.response?.data?.message||"Erro ao completar cadastro.";i.error(y)}finally{n(!1)}};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:s}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-md w-full relative z-10 shadow-xl animate-in fade-in zoom-in duration-300",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:m==="phone"?"Entrar ou Cadastrar":"Complete seu Cadastro"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(v,{className:"h-6 w-6"})})]}),m==="phone"?e.jsxs("form",{onSubmit:g,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"NÃºmero de Telefone"}),e.jsx("input",{type:"tel",value:l,onChange:r=>c(r.target.value),placeholder:"(00) 00000-0000",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#ff3d03] focus:border-transparent transition-all outline-none",required:!0})]}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-[#ff3d03] hover:bg-[#e63700] text-white font-bold py-3 rounded-xl transition-colors disabled:opacity-50",children:o?"Verificando...":"Continuar"})]}):e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Seu Nome"}),e.jsx("input",{type:"text",value:f,onChange:r=>x(r.target.value),placeholder:"Digite seu nome",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#ff3d03] focus:border-transparent transition-all outline-none",required:!0})]}),e.jsx("button",{type:"submit",disabled:o,className:"w-full bg-[#ff3d03] hover:bg-[#e63700] text-white font-bold py-3 rounded-xl transition-colors disabled:opacity-50",children:o?"Cadastrando...":"Finalizar Cadastro"})]})]})]})}export{S as default};
