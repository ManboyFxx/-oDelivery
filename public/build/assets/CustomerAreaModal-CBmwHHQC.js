import{c as T,r as t,j as e,X as H,e as $,d as i}from"./app-BdORke9e.js";import{t as l}from"./index-DQcsEE3M.js";import{T as R}from"./trophy-BVLuvj5r.js";import{G as w}from"./gift-DTli0vqC.js";import{L as B}from"./log-out-D5bYoo4C.js";import{P as G}from"./plus-CCxwXr4F.js";import{P as I}from"./pen-BlJc7w87.js";import{T as U}from"./trash-2-LDi6n0fj.js";import{C as X}from"./check-9F5QNde4.js";import{H as J}from"./history-C1CrGtwE.js";const K=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],Q=T("house",K);function ne({isOpen:k,onClose:p,customer:d,onLogout:C,store:E}){if(!k)return null;const[n,_]=t.useState("info"),[b,A]=t.useState([]),[f,z]=t.useState([]),[V,y]=t.useState(!1),[m,S]=t.useState(1),[P,F]=t.useState(!1),[M,c]=t.useState(!1),[u,g]=t.useState(null),[r,a]=t.useState({street:"",number:"",complement:"",neighborhood:"",city:"",state:"",zip_code:""}),[j,N]=t.useState(!1),x=async()=>{try{const s=await i.get("/customer/addresses");A(s.data)}catch(s){console.error("Error loading addresses:",s),l.error("Erro ao carregar endereços.")}},h=async(s=1)=>{y(!0);try{const o=await i.get("/customer/orders",{params:{page:s,customer_id:d.id,tenant_id:E.settings.tenant_id}});z(o.data.orders),S(s),F(o.data.pagination.has_more)}catch(o){console.error("Error loading orders:",o),l.error("Erro ao carregar pedidos.")}finally{y(!1)}};t.useEffect(()=>{n==="addresses"&&x(),n==="orders"&&h(1)},[n]);const q=async s=>{s.preventDefault(),N(!0);try{u?(await i.put(`/customer/addresses/${u.id}`,r),l.success("Endereço atualizado!")):(await i.post("/customer/addresses",r),l.success("Endereço cadastrado!")),await x(),c(!1),g(null),v()}catch(o){console.error("Error saving address:",o),l.error(o.response?.data?.message||"Erro ao salvar endereço.")}finally{N(!1)}},O=async s=>{if(confirm("Tem certeza que deseja excluir este endereço?"))try{await i.delete(`/customer/addresses/${s}`),l.success("Endereço removido."),x()}catch{l.error("Erro ao remover endereço.")}},D=async s=>{try{await i.post(`/customer/addresses/${s}/set-default`),l.success("Endereço padrão atualizado."),x()}catch{l.error("Erro ao definir endereço padrão.")}},v=()=>{a({street:"",number:"",complement:"",neighborhood:"",city:"",state:"",zip_code:""})},L=s=>{g(s),a({street:s.street,number:s.number,complement:s.complement||"",neighborhood:s.neighborhood,city:s.city,state:s.state,zip_code:s.zip_code}),c(!0)};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:p}),e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col relative z-20 shadow-2xl animate-in fade-in zoom-in duration-300",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Minha Conta"}),e.jsx("button",{onClick:p,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(H,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex border-b bg-gray-50/50",children:["info","addresses","orders"].map(s=>e.jsx("button",{onClick:()=>_(s),className:$("flex-1 py-4 text-sm font-bold transition-all border-b-2",n===s?"text-[#ff3d03] border-[#ff3d03] bg-white":"text-gray-500 border-transparent hover:text-gray-700 hover:bg-gray-100"),children:s==="info"?"Meus Dados":s==="addresses"?"Endereços":"Pedidos"},s))}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50/30",children:[n==="info"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-gray-100 shadow-sm",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:d.name}),e.jsx("p",{className:"text-gray-500",children:d.phone})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-900 to-gray-800 rounded-2xl p-6 text-white relative overflow-hidden shadow-xl group",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-[0.15] group-hover:scale-110 transition-transform duration-700",children:e.jsx(R,{size:140})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-white/10 rounded-xl backdrop-blur-sm",children:e.jsx(w,{className:"h-6 w-6 text-[#ff3d03]"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Programa de Fidelidade"}),e.jsx("p",{className:"font-bold text-lg",children:d.loyalty_tier?`${d.loyalty_tier} Member`:"Membro Bronze"})]})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-[#ff3d03] to-orange-400",children:d.loyalty_points||0}),e.jsx("span",{className:"text-lg font-bold text-gray-400",children:"pontos"})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Acumule pontos e troque por recompensas exclusivas!"})]})]}),e.jsxs("button",{onClick:C,className:"w-full flex items-center justify-center gap-2 bg-red-50 text-red-600 font-bold py-4 rounded-xl hover:bg-red-100 transition-colors",children:[e.jsx(B,{className:"h-5 w-5"}),"Sair da Conta"]})]}),n==="addresses"&&e.jsx("div",{className:"space-y-4",children:M?e.jsxs("form",{onSubmit:q,className:"bg-white p-6 rounded-2xl border border-gray-200",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-4",children:u?"Editar Endereço":"Novo Endereço"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"CEP"}),e.jsx("input",{type:"text",value:r.zip_code,onChange:s=>a({...r,zip_code:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]",required:!0})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Rua"}),e.jsx("input",{type:"text",value:r.street,onChange:s=>a({...r,street:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Número"}),e.jsx("input",{type:"text",value:r.number,onChange:s=>a({...r,number:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Comp."}),e.jsx("input",{type:"text",value:r.complement,onChange:s=>a({...r,complement:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Bairro"}),e.jsx("input",{type:"text",value:r.neighborhood,onChange:s=>a({...r,neighborhood:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Cidade"}),e.jsx("input",{type:"text",value:r.city,onChange:s=>a({...r,city:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"UF"}),e.jsx("input",{type:"text",maxLength:2,value:r.state,onChange:s=>a({...r,state:s.target.value}),className:"w-full p-3 bg-gray-50 rounded-xl border-none focus:ring-2 focus:ring-[#ff3d03]",required:!0})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{c(!1),v(),g(null)},className:"flex-1 py-3 font-bold text-gray-500 hover:bg-gray-100 rounded-xl transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:j,className:"flex-1 py-3 bg-[#ff3d03] text-white font-bold rounded-xl hover:bg-[#e63700] transition-colors shadow-lg shadow-orange-500/30",children:j?"Salvando...":"Salvar Endereço"})]})]}):e.jsxs(e.Fragment,{children:[b.length<3&&e.jsxs("button",{onClick:()=>c(!0),className:"w-full flex items-center justify-center gap-2 bg-white border-2 border-dashed border-gray-300 text-gray-600 font-bold py-4 rounded-xl hover:border-[#ff3d03] hover:text-[#ff3d03] hover:bg-orange-50 transition-all",children:[e.jsx(G,{className:"h-5 w-5"}),"Adicionar Novo Endereço"]}),b.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-50 rounded-lg",children:e.jsx(Q,{className:"h-5 w-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-gray-900",children:[s.street,", ",s.number]}),s.complement&&e.jsx("p",{className:"text-sm text-gray-600",children:s.complement}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.neighborhood," • ",s.city,"/",s.state]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["CEP: ",s.zip_code]})]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>L(s),className:"p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",children:e.jsx(I,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>O(s.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(U,{className:"h-4 w-4"})})]})]}),s.is_default?e.jsxs("div",{className:"inline-flex items-center gap-1.5 text-xs font-bold text-green-700 bg-green-50 px-3 py-1.5 rounded-full",children:[e.jsx(X,{className:"h-3 w-3"})," Padrão"]}):e.jsx("button",{onClick:()=>D(s.id),className:"text-xs font-bold text-gray-500 hover:text-[#ff3d03] transition-colors",children:"Definir como padrão"})]},s.id))]})}),n==="orders"&&e.jsxs("div",{className:"space-y-4",children:[f.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx(J,{className:"h-16 w-16 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Nenhum pedido realizado ainda."})]}):f.map(s=>e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"font-black text-gray-900",children:["#",s.order_number]}),e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded-lg text-xs font-bold text-gray-600 uppercase",children:s.status})]}),e.jsx("div",{className:"text-sm text-gray-500 mb-3",children:new Date(s.created_at).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}),e.jsxs("div",{className:"flex justify-between items-end border-t border-gray-50 pt-3",children:[s.loyalty_points_earned>0&&e.jsxs("div",{className:"flex items-center gap-1 text-orange-500 font-bold text-xs",children:[e.jsx(w,{className:"h-3 w-3"}),"+",s.loyalty_points_earned," pts"]}),e.jsxs("div",{className:"font-black text-gray-900 ml-auto",children:["R$ ",Number(s.total).toFixed(2).replace(".",",")]})]})]},s.id)),e.jsxs("div",{className:"flex justify-center gap-2 pt-4",children:[m>1&&e.jsx("button",{onClick:()=>h(m-1),className:"px-4 py-2 bg-gray-100 rounded-lg font-bold text-gray-600",children:"Anterior"}),P&&e.jsx("button",{onClick:()=>h(m+1),className:"px-4 py-2 bg-[#ff3d03] rounded-lg font-bold text-white",children:"Próximos"})]})]})]})]})]})}export{ne as default};
