import{r as i,f as C,j as e,d as h}from"./app-B_J8lkvq.js";import{T as o}from"./TextInput-CF_NLL-i.js";import{I as l}from"./InputLabel-DgCzgfTB.js";import{P as w}from"./PrimaryButton-yomEzznH.js";import{S as E}from"./SecondaryButton-DwxEYMC-.js";import{L as p}from"./loader-circle-BYYjQVCF.js";import{S}from"./search-BGAmxcu_.js";function q({onCancel:d,onSuccess:x,tenantId:g,customerId:v}){const[c,m]=i.useState(!1),[f,u]=i.useState(!1),[a,s]=i.useState({zip_code:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:""}),{success:j,error:n}=C(),b=async()=>{const t=a.zip_code.replace(/\D/g,"");if(t.length===8){u(!0);try{const r=await h.get(`https://viacep.com.br/ws/${t}/json/`);if(r.data.erro){n("CEP não encontrado","Verifique o CEP digitado.");return}s(N=>({...N,street:r.data.logradouro,neighborhood:r.data.bairro,city:r.data.localidade,state:r.data.uf}))}catch{n("Erro ao buscar CEP","Tente preencher manualmente.")}finally{u(!1)}}},y=async t=>{t.preventDefault(),m(!0);try{const r=await h.post("/customer/addresses",{...a,tenant_id:g,customer_id:v});j("Endereço adicionado!","Seu novo endereço foi salvo."),x(r.data)}catch(r){n("Erro ao salvar",r.response?.data?.message||"Tente novamente.")}finally{m(!1)}};return e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-gray-900 dark:text-white transition-colors",children:"Novo Endereço"}),e.jsx("button",{type:"button",onClick:d,className:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:"Cancelar"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"zip_code",value:"CEP"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{id:"zip_code",value:a.zip_code,onChange:t=>s({...a,zip_code:t.target.value}),onBlur:b,className:"w-full pl-10",placeholder:"00000-000",required:!0}),e.jsx("div",{className:"absolute left-3 top-2.5 text-gray-400 dark:text-gray-500",children:f?e.jsx(p,{className:"w-5 h-5 animate-spin"}):e.jsx(S,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"street",value:"Rua / Avenida"}),e.jsx(o,{id:"street",value:a.street,onChange:t=>s({...a,street:t.target.value}),className:"w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"number",value:"Número"}),e.jsx(o,{id:"number",value:a.number,onChange:t=>s({...a,number:t.target.value}),className:"w-full",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"complement",value:"Complemento (Opcional)"}),e.jsx(o,{id:"complement",value:a.complement,onChange:t=>s({...a,complement:t.target.value}),className:"w-full",placeholder:"Ap 102, Bloco C..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"neighborhood",value:"Bairro"}),e.jsx(o,{id:"neighborhood",value:a.neighborhood,onChange:t=>s({...a,neighborhood:t.target.value}),className:"w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"city",value:"Cidade - UF"}),e.jsx(o,{id:"city",value:`${a.city} - ${a.state}`,readOnly:!0,className:"w-full bg-gray-50 dark:bg-white/5 dark:text-gray-400"})]})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx(E,{type:"button",onClick:d,className:"flex-1 justify-center",children:"Voltar"}),e.jsx(w,{type:"submit",disabled:c,className:"flex-1 justify-center bg-[#ff3d03] hover:bg-[#e63700]",children:c?e.jsx(p,{className:"w-4 h-4 animate-spin"}):"Salvar Endereço"})]})]})}export{q as default};
