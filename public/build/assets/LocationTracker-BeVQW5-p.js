import{r as l,e as h}from"./app-BLG6vSpO.js";function E({orderId:p,enabled:u=!0,interval:g=10,onLocationUpdate:n,onError:i}){const s=l.useRef(null),d=l.useRef(0);l.useEffect(()=>{if(!u||!navigator.geolocation){navigator.geolocation||i?.("Geolocalização não disponível neste navegador");return}I();const a={enableHighAccuracy:!0,timeout:3e4,maximumAge:0};return s.current=navigator.geolocation.watchPosition(o=>{const{latitude:e,longitude:t,accuracy:r,speed:c,heading:f}=o.coords,v=Date.now();v-d.current>=g*1e3&&(m({latitude:e,longitude:t,accuracy:r,speed:c,heading:f}),d.current=v),n?.({latitude:e,longitude:t,accuracy:r,speed:c,heading:f,timestamp:new Date().toISOString()})},o=>{let e="Erro ao obter localização";switch(o.code){case o.PERMISSION_DENIED:e="Permissão de localização negada";break;case o.POSITION_UNAVAILABLE:e="Localização indisponível";break;case o.TIMEOUT:e="Timeout ao obter localização";break}i?.(e),console.error("Geolocation error:",o)},a),()=>{s.current!==null&&navigator.geolocation.clearWatch(s.current)}},[u,g,n,i]);const I=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(a=>{const{latitude:o,longitude:e,accuracy:t,speed:r,heading:c}=a.coords;m({latitude:o,longitude:e,accuracy:t,speed:r,heading:c}),n?.({latitude:o,longitude:e,accuracy:t,speed:r,heading:c,timestamp:new Date().toISOString()})},a=>{console.error("Erro ao obter localização:",a)})},m=async a=>{try{await h.post(route("api.motoboy.location.store"),{...a,order_id:p||null})}catch(o){console.error("Erro ao salvar localização:",o)}};return null}export{E as L};
