import{r,g as me,j as t,H as ue,d as B}from"./app-BeiTK8O7.js";import{u as pe}from"./usePushNotifications-DUwXs6sv.js";import{t as u}from"./index-D3vGHX22.js";import fe from"./HeroSection-r_V-qA0B.js";import he from"./CategoryNav-CEF7zATn.js";import xe from"./ProductGrid-n6VphuGr.js";import ge from"./CartSidebar-DL_IeAP-.js";import je from"./StoreInfoModal-B3hblDVQ.js";import we from"./ProductModal-jh2hiDmm.js";import ve from"./AuthModal-C2HXsLOA.js";import be from"./CustomerAreaModal-Bzro0xNi.js";import Se from"./CheckoutModal-BomvDOYp.js";import Ce from"./MenuNavbar-DvMJbWcx.js";import ye from"./FeaturedProductCard-1ug8af88.js";import{F as ke}from"./flame-DZo_7AKu.js";import"./search-a38Vqx5c.js";import"./sun-Ka4C_pFu.js";import"./instagram-ZNaGKETp.js";import"./message-circle-DBV9lRRh.js";import"./map-pin-6dfgS09F.js";import"./ProductCard-DZl44pN_.js";import"./plus-CXYls96f.js";import"./ProductCardSkeleton-C6De1P4Z.js";import"./shopping-bag-hl0p71xX.js";import"./pen-BNBfp7kR.js";import"./trash-2--0rQBpLT.js";import"./minus-D-1Hfc7b.js";import"./chevron-right-Byj7wEsR.js";import"./clock-BXCeX13J.js";import"./star-CvHf3rTp.js";import"./navigation-xmUWa6Wi.js";import"./share-2-CCxx5gA3.js";import"./AddressForm-BQqwQcyj.js";import"./TextInput-B4Hzd_yL.js";import"./InputLabel-DgrbSU8z.js";import"./PrimaryButton-Ce1OIklR.js";import"./SecondaryButton-C6DwDxfj.js";import"./loader-circle-m-BePsOh.js";import"./bell-BgpWhUXC.js";import"./gift-64ppZ22e.js";import"./trophy-woHj7yoO.js";import"./log-out-jkVU1Rox.js";import"./house-oTtn35Cq.js";import"./check-2lv-AJTh.js";import"./history-nRGwUKmU.js";import"./copy-lWBA-HTU.js";import"./Modal-2QFZ16oO.js";import"./keyboard-B_lk7WoT.js";import"./use-sync-refs-Bh1C4zpM.js";import"./portal-Iwu6bisq.js";import"./with-selector-oSkNhEYU.js";import"./hidden-CMxKSJQJ.js";import"./transition-CBp3oMBM.js";import"./sparkles-BF5bjgPf.js";import"./arrow-left-BwlAY5OQ.js";import"./circle-check-big-BNyxzmGn.js";import"./wallet-C-Y0B96j.js";import"./ticket-DneXDJ_e.js";import"./credit-card-CIOk5m4Q.js";import"./banknote-BnMOvwHO.js";import"./switch-D1W3lKyY.js";import"./use-resolve-button-type-DRTzruyL.js";import"./store-C7665HT-.js";import"./user-7qLq9AHd.js";function D(s,i){s=s.replace(/^#/,"");let c=parseInt(s.substring(0,2),16),l=parseInt(s.substring(2,4),16),p=parseInt(s.substring(4,6),16);c=Math.floor(c*(1+i/100)),l=Math.floor(l*(1+i/100)),p=Math.floor(p*(1+i/100)),c=Math.min(255,Math.max(0,c)),l=Math.min(255,Math.max(0,l)),p=Math.min(255,Math.max(0,p));const L=c.toString(16).padStart(2,"0"),x=l.toString(16).padStart(2,"0"),S=p.toString(16).padStart(2,"0");return`#${L}${x}${S}`}function zt({store:s,categories:i,slug:c,authCustomer:l,activePromotion:p,availableCoupons:L,activeTable:x}){pe(l);const[S,F]=r.useState(!0),[j,U]=r.useState("all"),[C,J]=r.useState(""),[m,f]=r.useState([]),[Q,O]=r.useState(null),[E,w]=r.useState(!1),[_,P]=r.useState(null),[W,A]=r.useState(null),[y,h]=r.useState(!1),[T,k]=r.useState(!1),[M,v]=r.useState(!1),[b,g]=r.useState(!1);r.useEffect(()=>{if(typeof window<"u"){const d=new URLSearchParams(window.location.search).get("ref");d&&localStorage.setItem("referral_code",d)}const e=setTimeout(()=>F(!1),800);return()=>clearTimeout(e)},[]);const[a,z]=r.useState(l),[G,H]=r.useState([]),[I,Y]=r.useState(()=>{const e=localStorage.getItem("menu_theme");return e?e==="dark":s.theme_mode==="dark"?!0:s.theme_mode==="light"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches}),K=()=>{Y(e=>{const o=!e;return localStorage.setItem("menu_theme",o?"dark":"light"),o})},X=async()=>{if(a)try{const e=await B.get("/customer/addresses");H(e.data)}catch(e){console.error("Error loading addresses:",e)}};r.useEffect(()=>{a?X():H([])},[a]);const{play:Z,initializeAudio:V}=me();r.useEffect(()=>{const e=()=>V();return window.addEventListener("click",e,{once:!0}),window.addEventListener("touchstart",e,{once:!0}),()=>{window.removeEventListener("click",e),window.removeEventListener("touchstart",e)}},[V]),r.useEffect(()=>{const e=localStorage.getItem("cart");if(e)try{f(JSON.parse(e))}catch(o){console.error("Error parsing cart",o)}},[]),r.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(m))},[m]),r.useEffect(()=>{const e=window.document.documentElement;I?e.classList.add("dark"):e.classList.remove("dark")},[I]),r.useEffect(()=>{const e=()=>{};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[i]);const ee=e=>{if(U(e),e!=="all"){const o=document.getElementById(e);if(o){const n=o.getBoundingClientRect().top+window.scrollY-120;window.scrollTo({top:n,behavior:"smooth"})}}else window.scrollTo({top:0,behavior:"smooth"})},$=e=>{if(!s.is_open){u.error("Desculpe, a loja está fechada no momento.");return}O(e),A(null),P(null),w(!0)},te=e=>{_!==null?(f(o=>o.map((d,n)=>n===_?e:d)),u.success("Item atualizado com sucesso!")):(f(o=>[...o,e]),u.success("Adicionado ao carrinho!"),Z("success")),w(!1)},oe=e=>{const o=m[e];O(o.product),A(o),P(e),w(!0),h(!1)},re=e=>{f(o=>o.filter((d,n)=>n!==e)),u.info("Item removido do carrinho.")},se=()=>{if(!s.is_open){u.error("Desculpe, a loja está fechada para novos pedidos.");return}if(!a){u.info("Para finalizar, indentifique-se primeiro."),v(!0),h(!1);return}N(!0),h(!1)},[R,N]=r.useState(!1),ae=e=>{z(e)},ne=async()=>{try{await B.post("/customer/logout"),z(null),u.info("Você saiu da conta."),g(!1)}catch(e){console.error(e)}},ie=m.reduce((e,o)=>e+o.subtotal,0),q=m.reduce((e,o)=>e+o.quantity,0),le=(e,o)=>{o<1||f(d=>d.map((n,de)=>{if(de===e){const ce=n.subtotal/n.quantity;return{...n,quantity:o,subtotal:ce*o}}return n}))};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-premium-dark text-gray-900 dark:text-gray-100 font-sans selection:bg-orange-100 selection:text-orange-900 pb-40 md:pb-40 transition-colors duration-300",children:[t.jsx(ue,{title:s.name,children:t.jsx("style",{children:`
                    :root {
                        --primary-color: ${s.theme_color||"#ff3d03"};
                        --primary-hover: ${D(s.theme_color||"#ff3d03",-10)};
                        --primary-active: ${D(s.theme_color||"#ff3d03",-20)};
                    }
                `})}),t.jsx(fe,{store:s,customer:a,onOpenAuth:()=>v(!0),onOpenProfile:()=>g(!0),onOpenCart:()=>h(!0),onOpenInfo:()=>k(!0),cartCount:q,searchQuery:C,setSearchQuery:J,isDark:I,toggleTheme:K}),x&&t.jsx("div",{className:"max-w-7xl mx-auto px-4 mt-6",children:t.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border-2 border-orange-400 dark:border-orange-500 rounded-2xl p-4 flex items-center justify-between shadow-sm animate-in fade-in slide-in-from-top-4 duration-500",children:t.jsxs("div",{className:"flex items-center gap-3 text-orange-800 dark:text-orange-200",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-orange-200 dark:bg-orange-800 flex items-center justify-center shrink-0",children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M5 11h14"}),t.jsx("path",{d:"M12 11V3"}),t.jsx("path",{d:"M8 3h8"}),t.jsx("path",{d:"M3 21h18"}),t.jsx("path",{d:"m4 11 1 10"}),t.jsx("path",{d:"m20 11-1 10"})]})}),t.jsxs("div",{children:[t.jsxs("h3",{className:"font-bold text-lg md:text-xl",children:["Você está na Mesa ",x.number]}),t.jsx("p",{className:"text-sm opacity-80",children:"Seus pedidos serão enviados direto para a cozinha."})]})]})})}),!C&&j==="all"&&i.some(e=>e.products.some(o=>o.is_featured))&&t.jsx("section",{className:"max-w-7xl mx-auto px-4 md:px-8 py-8",children:t.jsxs("div",{className:"mb-6 flex flex-col items-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-3",children:[t.jsx("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-orange-500 to-red-500 text-white flex items-center justify-center rotate-3 shadow-lg",children:t.jsx(ke,{className:"h-5 w-5"})}),t.jsx("div",{children:t.jsx("h2",{className:"text-xl md:text-2xl font-black text-gray-900 dark:text-white tracking-tight text-center",children:"Melhores da casa"})})]}),t.jsx("div",{className:"flex flex-wrap justify-center gap-6 md:gap-8 mt-10",children:i.flatMap(e=>e.products).filter(e=>e.is_featured).map(e=>t.jsx(ye,{product:e,onAdd:$,isStoreOpen:s.is_open},e.id))})]})}),t.jsx(he,{categories:i,activeCategory:j,onSelectCategory:ee}),!s.is_open&&t.jsx("div",{className:"max-w-7xl mx-auto px-4 mt-6",children:t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800/50 rounded-2xl p-4 flex items-center justify-center gap-3 text-red-600 dark:text-red-400",children:[t.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsx("span",{className:"font-bold text-sm md:text-base",children:"Loja Fechada. Pedidos temporariamente indisponíveis."})]})}),t.jsx("main",{children:t.jsx("div",{className:"flex flex-col md:flex-row max-w-7xl mx-auto items-start gap-6",children:t.jsx("div",{className:"flex-1 w-full",children:t.jsx(xe,{categories:i.map(e=>({...e,products:e.products.filter(o=>o.name.toLowerCase().includes(C.toLowerCase())&&(j==="all"||e.id===j))})).filter(e=>e.products.length>0),onAdd:$,viewMode:s.menu_view_mode||"grid",isStoreOpen:s.is_open,isLoading:S})})})}),t.jsx(ge,{isOpen:y,onClose:()=>h(!1),cart:m,onUpdateQuantity:le,onEdit:oe,onRemove:re,onCheckout:se}),t.jsx(je,{isOpen:T,onClose:()=>k(!1),store:s}),E&&t.jsx(we,{product:Q,isOpen:E,onClose:()=>w(!1),onAddToCart:te,initialValues:W}),M&&t.jsx(ve,{isOpen:M,onClose:()=>v(!1),onLogin:ae,slug:c}),b&&t.jsx(be,{isOpen:b,onClose:()=>g(!1),customer:a,onLogout:ne,store:s}),R&&t.jsx(Se,{show:R,onClose:()=>N(!1),cart:m,customer:a,store:s,total:ie,addresses:G,activeTable:x,onSuccess:()=>{f([]),N(!1)}}),a&&!y&&!b&&t.jsx("div",{className:"fixed top-4 right-4 z-40 hidden md:block",children:t.jsxs("button",{onClick:()=>g(!0),className:"bg-white px-4 py-2 rounded-full shadow-lg border border-gray-100 flex items-center gap-2 hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs uppercase",children:a.name.substring(0,2)}),t.jsx("span",{className:"font-bold text-gray-700 text-sm",children:a.name.split(" ")[0]})]})}),t.jsx(Ce,{customer:a,cartCount:q,onHome:()=>window.scrollTo({top:0,behavior:"smooth"}),onAccount:()=>{a?g(!0):v(!0)},onStore:()=>k(!0),onCart:()=>h(!0),activeTab:y?"cart":b||M?"account":T?"store":"home"})]})}export{zt as default};
