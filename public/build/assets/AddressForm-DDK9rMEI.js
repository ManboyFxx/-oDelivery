import{d as i,j as e,ai as h,G as C}from"./vendor-react-BYm2vN5O.js";import{a as p}from"./vendor-utils-DuuP9eDp.js";import{u as w}from"./app-Dqn1zKfB.js";import{T as o}from"./TextInput-D00-Dvyn.js";import{I as l}from"./InputLabel-BmqANJC9.js";import{P as E}from"./PrimaryButton-C8-r8q-u.js";import{S}from"./SecondaryButton-CCdDDmH-.js";import"./vendor-others-BqROYnIz.js";import"./vendor-animation-DqfYcVFE.js";function I({onCancel:c,onSuccess:x,tenantId:g,customerId:v}){const[d,m]=i.useState(!1),[f,u]=i.useState(!1),[a,r]=i.useState({zip_code:"",street:"",number:"",complement:"",neighborhood:"",city:"",state:""}),{success:j,error:n}=w(),b=async()=>{const s=a.zip_code.replace(/\D/g,"");if(s.length===8){u(!0);try{const t=await p.get(`https://viacep.com.br/ws/${s}/json/`);if(t.data.erro){n("CEP não encontrado","Verifique o CEP digitado.");return}r(N=>({...N,street:t.data.logradouro,neighborhood:t.data.bairro,city:t.data.localidade,state:t.data.uf}))}catch{n("Erro ao buscar CEP","Tente preencher manualmente.")}finally{u(!1)}}},y=async s=>{s.preventDefault(),m(!0);try{const t=await p.post("/customer/addresses",{...a,tenant_id:g,customer_id:v});j("Endereço adicionado!","Seu novo endereço foi salvo."),x(t.data)}catch(t){n("Erro ao salvar",t.response?.data?.message||"Tente novamente.")}finally{m(!1)}};return e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-gray-900",children:"Novo Endereço"}),e.jsx("button",{type:"button",onClick:c,className:"text-sm text-gray-500 hover:text-gray-700",children:"Cancelar"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"zip_code",value:"CEP"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{id:"zip_code",value:a.zip_code,onChange:s=>r({...a,zip_code:s.target.value}),onBlur:b,className:"w-full pl-10",placeholder:"00000-000",required:!0}),e.jsx("div",{className:"absolute left-3 top-2.5 text-gray-400",children:f?e.jsx(h,{className:"w-5 h-5 animate-spin"}):e.jsx(C,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(l,{htmlFor:"street",value:"Rua / Avenida"}),e.jsx(o,{id:"street",value:a.street,onChange:s=>r({...a,street:s.target.value}),className:"w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"number",value:"Número"}),e.jsx(o,{id:"number",value:a.number,onChange:s=>r({...a,number:s.target.value}),className:"w-full",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"complement",value:"Complemento (Opcional)"}),e.jsx(o,{id:"complement",value:a.complement,onChange:s=>r({...a,complement:s.target.value}),className:"w-full",placeholder:"Ap 102, Bloco C..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"neighborhood",value:"Bairro"}),e.jsx(o,{id:"neighborhood",value:a.neighborhood,onChange:s=>r({...a,neighborhood:s.target.value}),className:"w-full",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"city",value:"Cidade - UF"}),e.jsx(o,{id:"city",value:`${a.city} - ${a.state}`,readOnly:!0,className:"w-full bg-gray-50"})]})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx(S,{type:"button",onClick:c,className:"flex-1 justify-center",children:"Voltar"}),e.jsx(E,{type:"submit",disabled:d,className:"flex-1 justify-center bg-[#ff3d03] hover:bg-[#e63700]",children:d?e.jsx(h,{className:"w-4 h-4 animate-spin"}):"Salvar Endereço"})]})]})}export{I as default};
