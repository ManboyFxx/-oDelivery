import{d as l}from"./vendor-react-BRbeZxQj.js";import{a as h}from"./vendor-utils-Dp_nMyUE.js";function S({orderId:v,enabled:u=!0,interval:g=10,onLocationUpdate:n,onError:i}){const s=l.useRef(null),d=l.useRef(0);l.useEffect(()=>{if(!u||!navigator.geolocation){navigator.geolocation||i?.("Geolocalização não disponível neste navegador");return}I();const e={enableHighAccuracy:!0,timeout:3e4,maximumAge:0};return s.current=navigator.geolocation.watchPosition(o=>{const{latitude:a,longitude:t,accuracy:r,speed:c,heading:f}=o.coords,p=Date.now();p-d.current>=g*1e3&&(m({latitude:a,longitude:t,accuracy:r,speed:c,heading:f}),d.current=p),n?.({latitude:a,longitude:t,accuracy:r,speed:c,heading:f,timestamp:new Date().toISOString()})},o=>{let a="Erro ao obter localização";switch(o.code){case o.PERMISSION_DENIED:a="Permissão de localização negada";break;case o.POSITION_UNAVAILABLE:a="Localização indisponível";break;case o.TIMEOUT:a="Timeout ao obter localização";break}i?.(a),console.error("Geolocation error:",o)},e),()=>{s.current!==null&&navigator.geolocation.clearWatch(s.current)}},[u,g,n,i]);const I=async()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{const{latitude:o,longitude:a,accuracy:t,speed:r,heading:c}=e.coords;m({latitude:o,longitude:a,accuracy:t,speed:r,heading:c}),n?.({latitude:o,longitude:a,accuracy:t,speed:r,heading:c,timestamp:new Date().toISOString()})},e=>{console.error("Erro ao obter localização:",e)})},m=async e=>{try{await h.post(route("api.motoboy.location.store"),{...e,order_id:v||null})}catch(o){console.error("Erro ao salvar localização:",o)}};return null}export{S as L};
