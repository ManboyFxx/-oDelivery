import{r,j as o,H as ae,d as T}from"./app-CCgVoYEQ.js";import{u as ne,S as ie,M as le}from"./useAudio-BZ5jkVJA.js";import{t as m}from"./index-CEu0ySQD.js";import ce from"./HeroSection-CLsT9dMz.js";import de from"./CategoryNav-BT90VOvt.js";import me from"./ProductGrid-D1tKE4l0.js";import ue from"./CartFloatingButton-D-j9TCDB.js";import pe from"./CartSidebar-DRaCguCc.js";import fe from"./StoreInfoModal-CAQ532Es.js";import he from"./ProductModal-COtiauE8.js";import ge from"./AuthModal-rg_Lr9dm.js";import xe from"./CustomerAreaModal-B14bHha3.js";import we from"./CheckoutModal-C_3n1zX4.js";import{S as be}from"./search-DLr_Xhyt.js";import"./chevron-right-QrR7QbDr.js";import"./user-BGtzAZhV.js";import"./instagram-B-cIGTTJ.js";import"./message-circle-BCTbBdbK.js";import"./map-pin-CihiAg2i.js";import"./navigation-BApV9lq0.js";import"./ProductCard-H4bsYVf8.js";import"./plus-BdAvLtDu.js";import"./shopping-bag-BXjODdx7.js";import"./shopping-cart-CmNbpHhb.js";import"./pen-Cie1fxDe.js";import"./trash-2-tK0yr903.js";import"./minus-BGXpFceM.js";import"./clock-DmiTNz5U.js";import"./star-CqHjf4uw.js";import"./share-2-BEkFrdkK.js";import"./bell-1IVW0JAl.js";import"./gift-1wpzltOM.js";import"./trophy-CmPrCShO.js";import"./log-out-XdxYT9wm.js";import"./check-BV0ZIPXk.js";import"./history-DtJAdqn7.js";import"./copy-DnhtAMtN.js";import"./Modal-rsFWo1Ry.js";import"./keyboard-BRIR3wlq.js";import"./use-sync-refs-D0Pc_C8j.js";import"./portal-DEyrsJCl.js";import"./with-selector-CQ3QENBX.js";import"./hidden-dfAfSfNn.js";import"./transition-vUlZZAvv.js";import"./sparkles-BdxVYdTs.js";import"./AddressForm-C8ZT-sc7.js";import"./TextInput-BczBMDWj.js";import"./InputLabel-Cd-NfE0-.js";import"./PrimaryButton-B8tWqAj6.js";import"./SecondaryButton-DcxQ5Lgq.js";import"./loader-circle-RrWj1FYm.js";import"./arrow-left-COMqi0zl.js";import"./circle-check-big-BY4tTXLJ.js";import"./wallet-Ck5zMm5B.js";import"./ticket-BYoNT3ck.js";import"./credit-card-DNYgLdhn.js";import"./banknote-D4excANe.js";import"./switch-3Xb6eePU.js";import"./use-resolve-button-type-DEV79sNA.js";function Et({store:n,categories:h,slug:q,authCustomer:z,activePromotion:ye,availableCoupons:Ce}){const[g,H]=r.useState("all"),[y,R]=r.useState(""),[i,l]=r.useState([]),[V,C]=r.useState(null),[v,u]=r.useState(!1),[S,k]=r.useState(null),[B,j]=r.useState(null),[I,c]=r.useState(!1),[U,E]=r.useState(!1),[O,x]=r.useState(!1),[w,p]=r.useState(!1);r.useEffect(()=>{if(typeof window<"u"){const t=new URLSearchParams(window.location.search).get("ref");t&&localStorage.setItem("referral_code",t)}},[]);const[s,N]=r.useState(z),[D,A]=r.useState([]),[f,J]=r.useState(()=>{const e=localStorage.getItem("menu_theme");return e?e==="dark":n.theme_mode==="dark"?!0:n.theme_mode==="light"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches}),Q=()=>{J(e=>{const t=!e;return localStorage.setItem("menu_theme",t?"dark":"light"),t})},F=async()=>{if(s)try{const e=await T.get("/customer/addresses");A(e.data)}catch(e){console.error("Error loading addresses:",e)}};r.useEffect(()=>{s?F():A([])},[s]);const{play:G,initializeAudio:M}=ne();r.useEffect(()=>{const e=()=>M();return window.addEventListener("click",e,{once:!0}),window.addEventListener("touchstart",e,{once:!0}),()=>{window.removeEventListener("click",e),window.removeEventListener("touchstart",e)}},[M]),r.useEffect(()=>{const e=localStorage.getItem("cart");if(e)try{l(JSON.parse(e))}catch(t){console.error("Error parsing cart",t)}},[]),r.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(i))},[i]),r.useEffect(()=>{const e=window.document.documentElement;f?e.classList.add("dark"):e.classList.remove("dark")},[f]),r.useEffect(()=>{const e=()=>{};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[h]);const Y=e=>{if(H(e),e!=="all"){const t=document.getElementById(e);if(t){const a=t.getBoundingClientRect().top+window.scrollY-120;window.scrollTo({top:a,behavior:"smooth"})}}else window.scrollTo({top:0,behavior:"smooth"})},K=e=>{C(e),j(null),k(null),u(!0)},W=e=>{S!==null?(l(t=>t.map((d,a)=>a===S?e:d)),m.success("Item atualizado com sucesso!")):(l(t=>[...t,e]),m.success("Adicionado ao carrinho!"),G("success")),u(!1)},X=e=>{const t=i[e];C(t.product),j(t),k(e),u(!0),c(!1)},Z=e=>{l(t=>t.filter((d,a)=>a!==e)),m.info("Item removido do carrinho.")},$=()=>{if(!s){m.info("Para finalizar, indentifique-se primeiro."),x(!0),c(!1);return}b(!0),c(!1)},[L,b]=r.useState(!1),ee=e=>{N(e)},te=async()=>{try{await T.post("/customer/logout"),N(null),m.info("VocÃª saiu da conta."),p(!1)}catch(e){console.error(e)}},P=i.reduce((e,t)=>e+t.subtotal,0),_=i.reduce((e,t)=>e+t.quantity,0),oe=(e,t)=>{t<1||l(d=>d.map((a,re)=>{if(re===e){const se=a.subtotal/a.quantity;return{...a,quantity:t,subtotal:se*t}}return a}))};return o.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-premium-dark text-gray-900 dark:text-gray-100 font-sans selection:bg-orange-100 selection:text-orange-900 pb-24 md:pb-0 transition-colors duration-300",children:[o.jsx(ae,{title:n.name}),o.jsx(ce,{store:n,customer:s,onOpenAuth:()=>x(!0),onOpenProfile:()=>p(!0),onOpenCart:()=>c(!0),onOpenInfo:()=>E(!0),cartCount:_}),o.jsx("header",{className:"sticky top-0 z-40 bg-white/80 dark:bg-premium-dark/80 backdrop-blur-md shadow-sm border-b border-gray-100 dark:border-white/5 transition-colors duration-300",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-8 py-4 flex items-center justify-center gap-6",children:[o.jsx("div",{className:"flex-1 max-w-2xl",children:o.jsxs("div",{className:"relative group",children:[o.jsx(be,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400 group-focus-within:text-black transition-colors"}),o.jsx("input",{type:"text",placeholder:"O que vamos pedir agora?",value:y,onChange:e=>R(e.target.value),className:"w-full bg-gray-50/50 dark:bg-white/5 border border-transparent rounded-xl py-2.5 pl-11 pr-4 focus:ring-0 focus:border-gray-200 dark:focus:border-white/10 focus:bg-white dark:focus:bg-white/10 transition-all outline-none font-medium text-sm text-gray-900 dark:text-white placeholder:text-gray-950 dark:placeholder:text-gray-400"})]})}),o.jsx("button",{onClick:Q,"aria-label":f?"Ativar modo claro":"Ativar modo escuro",className:"h-10 w-10 rounded-xl bg-gray-100 dark:bg-white/10 flex items-center justify-center text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-white/20 active:scale-90 transition-all shrink-0",children:f?o.jsx(ie,{className:"h-4 w-4"}):o.jsx(le,{className:"h-4 w-4"})})]})}),o.jsx(de,{categories:h,activeCategory:g,onSelectCategory:Y}),o.jsx("main",{children:o.jsx("div",{className:"flex flex-col md:flex-row max-w-7xl mx-auto items-start gap-6",children:o.jsx("div",{className:"flex-1 w-full",children:o.jsx(me,{categories:h.map(e=>({...e,products:e.products.filter(t=>t.name.toLowerCase().includes(y.toLowerCase())&&(g==="all"||e.id===g))})).filter(e=>e.products.length>0),onAdd:K})})})}),o.jsx(ue,{itemCount:_,total:P,onClick:()=>c(!0)}),o.jsx(pe,{isOpen:I,onClose:()=>c(!1),cart:i,onUpdateQuantity:oe,onEdit:X,onRemove:Z,onCheckout:$}),o.jsx(fe,{isOpen:U,onClose:()=>E(!1),store:n}),v&&o.jsx(he,{product:V,isOpen:v,onClose:()=>u(!1),onAddToCart:W,initialValues:B}),O&&o.jsx(ge,{isOpen:O,onClose:()=>x(!1),onLogin:ee,slug:q}),w&&o.jsx(xe,{isOpen:w,onClose:()=>p(!1),customer:s,onLogout:te,store:n}),L&&o.jsx(we,{show:L,onClose:()=>b(!1),cart:i,customer:s,store:n,total:P,addresses:D,onSuccess:()=>{l([]),b(!1)}}),s&&!I&&!w&&o.jsx("div",{className:"fixed top-4 right-4 z-40 hidden md:block",children:o.jsxs("button",{onClick:()=>p(!0),className:"bg-white px-4 py-2 rounded-full shadow-lg border border-gray-100 flex items-center gap-2 hover:bg-gray-50 transition-colors",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-100 flex items-center justify-center text-[#ff3d03] font-bold text-xs uppercase",children:s.name.substring(0,2)}),o.jsx("span",{className:"font-bold text-gray-700 text-sm",children:s.name.split(" ")[0]})]})})]})}export{Et as default};
