import{r as m,g as O,j as e,f as w,e as b}from"./app-B5qJFbdJ.js";import{T as f}from"./TextInput-DGRVVkoe.js";import{I as h}from"./InputLabel-BDtkFhpw.js";import{P as k}from"./PrimaryButton-CJ8VYHdW.js";import{S as _}from"./SecondaryButton-XM-f-fNo.js";import{L as j}from"./loader-circle-Dn86C_3a.js";import{S as B}from"./search-LZxRxKz-.js";function I({onCancel:N,onSuccess:V,tenantId:l,customerId:S,preloadedZones:i=[],initialData:t,store:u}){const[g,D]=m.useState(!1),E=u?.address?.city||u?.settings?.address?.city||"",F=u?.address?.state||u?.settings?.address?.state||"",[r,d]=m.useState({zip_code:t?.zip_code||"00000-000",street:t?.street||"",number:t?.number||"",complement:t?.complement||"",neighborhood:t?.neighborhood||"",city:t?.city||E,state:t?.state||F}),{success:y,error:x}=O(),[c,v]=m.useState(i.length>0?i:null),[A,p]=m.useState(!0),[T,C]=m.useState(t?!0:null),P=i?.length||0;m.useEffect(()=>{let s=!0;const o=()=>{s&&p(!1)};if(i&&i.length>0){console.log("AddressForm: Using preloaded zones",i.length),v(i),o();return}if(!l){console.warn("AddressForm: Waiting for tenantId...");const n=setTimeout(o,3e3);return()=>{s=!1,clearTimeout(n)}}return(async()=>{if(s){p(!0);try{console.log("AddressForm: Fetching zones for tenant",l);const n=await b.get(`/api/delivery-zones?tenant_id=${l}`);console.log("AddressForm: Zones fetched",n.data?.length),s&&v(n.data||[])}catch(n){console.error("Error fetching delivery zones:",n),s&&v([])}finally{o()}}})(),()=>{s=!1}},[l,P]);const U=s=>{const o=s.target.value,a=c?.find(n=>n.neighborhood===o);d(n=>({...n,neighborhood:o})),C(a?!0:o?!1:null)},M=async s=>{if(s.preventDefault(),!r.neighborhood){x("Bairro obrigatório","Selecione o bairro de entrega.");return}D(!0);try{const o={...r,city:r.city||"Cidade",state:r.state||"UF",zip_code:r.zip_code||"00000-000",tenant_id:l,customer_id:S};let a;t?.id?(a=await b.put(`/customer/addresses/${t.id}`,o),y("Endereço atualizado!","Suas alterações foram salvas.")):(a=await b.post("/customer/addresses",o),y("Endereço adicionado!","Seu novo endereço foi salvo.")),V(a.data.address||a.data)}catch(o){x("Erro ao salvar",o.response?.data?.message||"Tente novamente.")}finally{D(!1)}};return e.jsxDEV("form",{onSubmit:M,className:"space-y-4",children:[e.jsxDEV("div",{className:"flex justify-between items-center mb-4",children:[e.jsxDEV("h3",{className:"font-bold text-gray-900 dark:text-white transition-colors",children:"Cadastrar Endereço"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:145,columnNumber:17},this),e.jsxDEV("button",{type:"button",onClick:N,className:"text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:"Cancelar"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:146,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:144,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV("div",{className:"flex justify-between items-center mb-1",children:e.jsxDEV(h,{htmlFor:"neighborhood",value:"Bairro de Entrega"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:154,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:153,columnNumber:17},this),e.jsxDEV("div",{className:"relative",children:A?e.jsxDEV("div",{className:"w-full border-2 border-gray-100 dark:border-gray-800 rounded-xl p-3 flex items-center justify-center text-gray-400 gap-2",children:[e.jsxDEV(j,{className:"w-4 h-4 animate-spin"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:160,columnNumber:29},this),e.jsxDEV("span",{className:"text-sm font-medium",children:"Buscando bairros..."},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:161,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:159,columnNumber:25},this):c&&c.length>0?e.jsxDEV("select",{id:"neighborhood",value:r.neighborhood,onChange:U,className:w("w-full border-2 rounded-xl shadow-sm outline-none transition-all duration-300 p-3","focus:ring-2 focus:ring-[#ff3d03] focus:border-transparent",T===!0?"border-green-500 bg-green-50/30 text-green-900 dark:bg-green-900/10 dark:text-green-400":"border-gray-200 dark:border-gray-700 dark:bg-gray-950 dark:text-gray-100 placeholder-gray-400"),required:!0,children:[e.jsxDEV("option",{value:"",children:"Selecione o Bairro..."},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:177,columnNumber:29},this),c.map(s=>e.jsxDEV("option",{value:s.neighborhood,children:[s.neighborhood," ",s.delivery_fee>0?`(+ R$ ${Number(s.delivery_fee).toFixed(2)})`:"(Entrega Grátis)"]},s.id||s.neighborhood,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:179,columnNumber:33},this))]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:164,columnNumber:25},this):e.jsxDEV("div",{className:"w-full border-2 border-amber-100 bg-amber-50 dark:bg-amber-900/10 dark:border-amber-900/30 rounded-xl p-3 text-amber-600 dark:text-amber-400 text-sm flex items-center gap-2",children:[e.jsxDEV(B,{className:"w-4 h-4"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:186,columnNumber:29},this),e.jsxDEV("span",{children:"Nenhum bairro de entrega configurado pela loja."},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:187,columnNumber:29},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:185,columnNumber:25},this)},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:157,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:152,columnNumber:13},this),e.jsxDEV("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxDEV("div",{className:"col-span-3",children:[e.jsxDEV(h,{htmlFor:"street",value:"Nome da Rua / Avenida"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:196,columnNumber:21},this),e.jsxDEV(f,{id:"street",value:r.street,onChange:s=>d({...r,street:s.target.value}),className:"w-full",placeholder:"Ex: Rua das Flores",required:!0},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:197,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:195,columnNumber:17},this),e.jsxDEV("div",{className:"col-span-1",children:[e.jsxDEV(h,{htmlFor:"number",value:"Nº"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:207,columnNumber:21},this),e.jsxDEV(f,{id:"number",value:r.number,onChange:s=>d({...r,number:s.target.value}),className:"w-full",placeholder:"123",required:!0},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:208,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:206,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:194,columnNumber:13},this),e.jsxDEV("div",{children:[e.jsxDEV(h,{htmlFor:"complement",value:"Complemento (Opcional)"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:221,columnNumber:17},this),e.jsxDEV(f,{id:"complement",value:r.complement,onChange:s=>d({...r,complement:s.target.value}),className:"w-full",placeholder:"Ex: Apt 42, Bloco B, Casa no fundo..."},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:222,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:220,columnNumber:13},this),e.jsxDEV("div",{className:"pt-4 flex gap-3",children:[e.jsxDEV(_,{type:"button",onClick:N,className:"flex-1 justify-center py-3",children:"Cancelar"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:232,columnNumber:17},this),e.jsxDEV(k,{type:"submit",disabled:g,className:"flex-1 justify-center bg-[#ff3d03] hover:bg-[#e63700] py-3 shadow-lg shadow-orange-500/20",children:g?e.jsxDEV(j,{className:"w-5 h-5 animate-spin mx-auto text-white"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:240,columnNumber:32},this):"Confirmar Endereço"},void 0,!1,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:235,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:231,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/Vertinho/Documents/Sistemas/OoDelivery/-oDelivery/resources/js/Pages/Tenant/Menu/Components/AddressForm.tsx",lineNumber:143,columnNumber:9},this)}export{I as default};
