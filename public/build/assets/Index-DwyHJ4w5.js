import{c as y,r as o,j as e,L as k,g as H,f as V,e as u,H as $,C as R,a as S}from"./app-Cz2FlK-X.js";import{a as U,A as q}from"./AuthenticatedLayout-BRg8X8-i.js";import{A as B}from"./ApplicationLogo-DdFIEX6t.js";import{C as E}from"./clock-C81beufX.js";import{P as G}from"./power-CLUQuw8E.js";import{k as X,l as J,D as Q,f as W,m as Y,P as Z}from"./core.esm-BckJOO1E.js";import{S as ee,v as te}from"./sortable.esm-CorQY66P.js";import C from"./DraggableKitchenCard-V_FPiXYU.js";import{V as se}from"./volume-2-CrR9m59x.js";import{U as re}from"./utensils-crossed-DxqNtQBd.js";import"./monitor-DCcDnjpR.js";import"./shopping-bag-CTZQWuU8.js";import"./package-j8qiwvly.js";import"./image-BrGhz3PF.js";import"./layout-dashboard-s7cc1WUc.js";import"./credit-card-iq0899F0.js";import"./users-q-aUcb25.js";import"./trophy-Bq5LeqhL.js";import"./ticket-BMRK4cci.js";import"./store-C5Zno6Px.js";import"./dollar-sign-DVAotz2y.js";import"./key-kez1Qm86.js";import"./shield-check-Cm1GtHgO.js";import"./log-out-CHy1zhEr.js";import"./transition-CRSyYdUI.js";import"./use-sync-refs-Cw5wNZXH.js";import"./Modal-C9lxCCAU.js";import"./keyboard-a7uHaJKk.js";import"./portal-B3X7_D_j.js";import"./with-selector-BhrssK9k.js";import"./hidden-BNnctkNA.js";import"./truck-N80-YtZw.js";import"./switch-B8p3SKCs.js";import"./use-resolve-button-type-BqgbvpS-.js";import"./menu-DApYnhd1.js";import"./chevron-down-C2ZP5H8w.js";import"./circle-play-D9gEtnZy.js";import"./menu-T1lYYjQt.js";import"./search-DFX2nYcc.js";import"./sun-DMczBmwe.js";import"./bell-CsmCO2lu.js";import"./eye-BLo4v0L-.js";import"./arrow-left-BIOjJWvJ.js";import"./usePushNotifications-yiXeBVVK.js";import"./zap-LJ3l74lM.js";import"./star-D_xrVok1.js";import"./chevron-right-g7BsehEN.js";import"./lock-CTPcfyxV.js";import"./timer-T8vcC3-5.js";const ae=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],D=y("maximize",ae);const ne=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],ie=y("minimize",ne);const oe=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],le=y("volume-x",oe);function ce({children:a,isFullscreen:h,toggleFullscreen:g}){const[p,x]=o.useState(new Date);return o.useEffect(()=>{const b=setInterval(()=>x(new Date),1e3);return()=>clearInterval(b)},[]),e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col",children:[e.jsxs("header",{className:"flex items-center justify-between px-6 py-3 bg-gray-800 border-b border-gray-700 shadow-lg shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(k,{href:"/",className:"shrink-0",children:e.jsx(B,{className:"block h-8 w-auto fill-current text-white"})}),e.jsx("div",{className:"h-6 w-px bg-gray-600 mx-2"}),e.jsx("h1",{className:"text-xl font-bold tracking-tight text-white/90",children:"KDS - Kitchen Display System"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300 font-mono text-lg bg-gray-900/50 px-4 py-1.5 rounded-lg border border-gray-700",children:[e.jsx(E,{className:"h-4 w-4 text-[#ff3d03]"}),e.jsx("span",{children:p.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:g,className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-200 transition-colors",title:h?"Sair da Tela Cheia":"Tela Cheia",children:h?e.jsx(ie,{className:"h-5 w-5"}):e.jsx(D,{className:"h-5 w-5"})}),e.jsxs(k,{href:"/dashboard",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[#ff3d03] hover:bg-[#e63700] rounded-lg transition-colors",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sair"})]})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden relative",children:e.jsx("div",{className:"absolute inset-0 p-4 overflow-auto scrollbar-hide",children:a})})]})}function nt({orders:a}){const[h,g]=o.useState({}),[p,x]=o.useState(null),[b,M]=o.useState(a.filter(t=>t.status==="new").length),[d,P]=o.useState(!0),[f,v]=o.useState(!1),{play:T}=H(),{soundEnabled:A}=V(),w=()=>{document.fullscreenElement?document.exitFullscreen().then(()=>{v(!1)}):document.documentElement.requestFullscreen().then(()=>{v(!0)}).catch(t=>{console.error(`Error attempting to enable fullscreen: ${t.message}`)})};o.useEffect(()=>{const t=()=>{v(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",t),()=>document.removeEventListener("fullscreenchange",t)},[]),o.useEffect(()=>{const t=a.filter(s=>s.status==="new").length;t>b&&d&&A&&T("new-order"),M(t)},[a,d]),o.useEffect(()=>{const t=window.page?.props?.auth?.user?.tenant_id||window.page?.props?.tenant?.id;let s=0;const n=setInterval(async()=>{if(t)try{const l=await fetch(`/api/poll/${t}`);if(!l.ok)return;const{timestamp:i}=await l.json();if(s===0){s=i;return}i>s&&(console.log("[KitchenPolling] Change detected via Poll File. Reloading..."),s=i,S.reload({only:["orders"],preserveScroll:!0,preserveState:!0}))}catch{}},15e3);return()=>clearInterval(n)},[]),o.useEffect(()=>{const t=setInterval(()=>{const s={};a.forEach(r=>{const n=new Date(r.created_at).getTime(),i=new Date().getTime()-n,m=Math.floor(i/(1e3*60)),c=Math.floor(i%(1e3*60)/1e3);s[r.id]=`${m}:${c.toString().padStart(2,"0")}`}),g(s)},1e3);return()=>clearInterval(t)},[a]);const I=(t,s)=>{S.post(route("kitchen.update-status",t),{status:s},{preserveScroll:!0,preserveState:!0})},L=a.filter(t=>t.status==="new"),O=a.filter(t=>t.status==="preparing"),_=a.filter(t=>t.status==="ready"),z=X(J(Z,{activationConstraint:{distance:8}})),K=t=>{const{active:s}=t,r=a.find(n=>n.id===s.id);x(r||null)},F=t=>{const{active:s,over:r}=t;if(x(null),!r)return;const n=s.id,l=r.id,i=a.find(m=>m.id===n);!i||i.status===l||I(n,l)},j=({id:t,title:s,orders:r,icon:n,color:l,bgClass:i,borderClass:m})=>e.jsxs("div",{className:u("flex flex-col rounded-2xl overflow-hidden border transition-all duration-300",i,m,f?"h-full":"h-[calc(100vh-200px)] min-h-[600px]"),children:[e.jsxs("div",{className:u("p-4 border-b flex justify-between items-center",m,l),children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold uppercase tracking-wider",children:[e.jsx(n,{className:"h-5 w-5"}),s]}),e.jsx("div",{className:u("px-2 py-1 rounded-lg text-xs font-bold bg-white/20"),children:r.length})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 scrollbar-hide",children:[e.jsx(ee,{id:t,items:r.map(c=>c.id),strategy:te,children:e.jsx("div",{className:"space-y-3 min-h-[100px]",children:r.map(c=>e.jsx(C,{order:c,elapsedTime:h[c.id]},c.id))})}),r.length===0&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 opacity-50",children:[e.jsx(n,{className:"h-12 w-12 mb-2"}),e.jsx("p",{className:"font-medium text-sm",children:"Vazio"})]})]})]}),N=e.jsxs("div",{className:u("flex flex-col h-full",f?"p-4":""),children:[e.jsx($,{title:"Cozinha (KDS)"}),!f&&e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black dark:text-white flex items-center gap-3",children:[e.jsx(U,{className:"h-8 w-8 text-[#ff3d03]"}),"Kitchen Display System"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Gerencie a produção em tempo real"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>P(!d),className:u("p-3 rounded-xl border transition-colors",d?"bg-white dark:bg-[#1a1b1e] border-gray-200 dark:border-white/10 text-[#ff3d03] shadow-sm":"bg-gray-100 dark:bg-white/5 border-transparent text-gray-400"),title:d?"Som Ativado":"Som Mudo",children:d?e.jsx(se,{className:"h-5 w-5"}):e.jsx(le,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-4 py-2 bg-gray-900 dark:bg-white text-white dark:text-gray-900 rounded-xl font-bold shadow-lg hover:scale-105 transition-transform",children:[e.jsx(D,{className:"h-4 w-4"}),"Modo Tela Cheia"]})]})]}),e.jsxs(Q,{sensors:z,collisionDetection:W,onDragStart:K,onDragEnd:F,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 h-full",children:[e.jsx("div",{id:"new",className:"h-full",children:e.jsx(j,{id:"new",title:"Novos Pedidos",orders:L,icon:E,color:"text-blue-500",bgClass:"bg-blue-50/50 dark:bg-blue-900/10",borderClass:"border-blue-100 dark:border-blue-500/20"})}),e.jsx("div",{id:"preparing",className:"h-full",children:e.jsx(j,{id:"preparing",title:"Em Preparo",orders:O,icon:re,color:"text-[#ff3d03]",bgClass:"bg-orange-50/50 dark:bg-orange-900/10",borderClass:"border-orange-100 dark:border-[#ff3d03]/20"})}),e.jsx("div",{id:"ready",className:"h-full",children:e.jsx(j,{id:"ready",title:"Prontos",orders:_,icon:R,color:"text-green-500",bgClass:"bg-green-50/50 dark:bg-green-900/10",borderClass:"border-green-100 dark:border-green-500/20"})})]}),e.jsx(Y,{children:p?e.jsx("div",{className:"w-[350px] rotate-3 cursor-grabbing opacity-90",children:e.jsx(C,{order:p,elapsedTime:h[p.id],isOverlay:!0})}):null})]})]});return f?e.jsx(ce,{isFullscreen:!0,toggleFullscreen:w,children:N}):e.jsx(q,{children:N})}export{nt as default};
