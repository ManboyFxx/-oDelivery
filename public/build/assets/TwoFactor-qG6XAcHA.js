import{r as l,j as e}from"./app-6zUSvVHt.js";import{A as S}from"./AuthenticatedLayout-CiLHomiV.js";import{S as A}from"./shield-cgi3OF08.js";import{C as y}from"./circle-alert-DyCwccGy.js";import{C as F}from"./check-BiBSN_fD.js";import{E}from"./eye-off-KRpDE6kX.js";import{E as R}from"./eye-C9peTssD.js";import{C as T}from"./copy-DCHN7cE6.js";import"./monitor-9c018sVF.js";import"./shopping-bag-Cfrmbu90.js";import"./package-qDtdRxCu.js";import"./image-B4JlNPQ1.js";import"./layout-dashboard-DgxyxPOS.js";import"./credit-card-cOTJS4Gq.js";import"./users-B4J01dbB.js";import"./trophy-D1YAVLDD.js";import"./ticket-DTWABZN8.js";import"./store-C-117Jwf.js";import"./dollar-sign-OrM4_IgI.js";import"./key-zQX2_ELO.js";import"./shield-check-cOFxPM_7.js";import"./log-out-ZvQDMoRt.js";import"./transition-BAEoU0QF.js";import"./use-sync-refs-CF9k2BeQ.js";import"./Modal-DS18DX4A.js";import"./keyboard-B62Orwlm.js";import"./portal-CiqeH5nL.js";import"./with-selector-9x1i3JTs.js";import"./hidden-qkw4PdP6.js";import"./truck-CDo-WXdV.js";import"./switch-BFWjoo7-.js";import"./use-resolve-button-type-DN2E8owd.js";import"./menu-nddPb2Am.js";import"./chevron-down-BRJcovI4.js";import"./clock-CBPOZ8ww.js";import"./circle-play-DLAVSY-Y.js";import"./menu-CzE-hhCV.js";import"./search-D2hL8533.js";import"./sun-D4iZbGUd.js";import"./bell-Cr-gEXRZ.js";import"./arrow-left-BE-vT9N8.js";import"./usePushNotifications-jNlVV5Le.js";import"./zap-Spzl7IF5.js";import"./star-DNuvin_Q.js";import"./chevron-right-Bs_UVw_3.js";import"./lock-D4lBL0iS.js";function Se({isEnabled:f,remainingCodes:c}){const[s,a]=l.useState({secret:null,qrCodeUrl:null,step:"idle",error:null}),[d,i]=l.useState(""),[j,m]=l.useState(!1),[x,w]=l.useState(!1),[g,p]=l.useState([]),[n,u]=l.useState(""),[D,q]=l.useState(!1),[h,b]=l.useState(!1),v=async()=>{a(r=>({...r,step:"generating",error:null}));try{const r=await fetch(route("two-factor.enable"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""}}),t=await r.json();r.ok?(a(o=>({...o,secret:t.secret,qrCodeUrl:t.qrCodeUrl,step:"idle"})),m(!0)):a(o=>({...o,step:"idle",error:t.error||"Erro ao gerar QR code"}))}catch{a(t=>({...t,step:"idle",error:"Erro ao conectar ao servidor"}))}},N=async()=>{if(!d||d.length!==6){a(r=>({...r,error:"Digite um código de 6 dígitos"}));return}a(r=>({...r,step:"verifying",error:null}));try{const r=await fetch(route("two-factor.confirm"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({secret:s.secret,code:d})}),t=await r.json();r.ok?(p(t.recovery_codes||[]),a(o=>({...o,step:"confirming"})),i("")):a(o=>({...o,step:"idle",error:t.error||"Código inválido"}))}catch{a(t=>({...t,step:"idle",error:"Erro ao verificar código"}))}},k=()=>{m(!1),a({secret:null,qrCodeUrl:null,step:"idle",error:null}),i(""),p([]),window.location.reload()},C=async()=>{if(!n){a(r=>({...r,error:"Digite sua senha para desativar 2FA"}));return}b(!0);try{const r=await fetch(route("two-factor.disable"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({password:n})}),t=await r.json();r.ok?(u(""),a({secret:null,qrCodeUrl:null,step:"idle",error:null}),window.location.reload()):a(o=>({...o,error:t.error||"Erro ao desativar 2FA"}))}catch{a(t=>({...t,error:"Erro ao conectar ao servidor"}))}finally{b(!1)}};return e.jsx(S,{children:e.jsxs("div",{className:"max-w-2xl mx-auto py-6 px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(A,{className:"h-8 w-8 text-blue-600"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Autenticação de Dois Fatores"})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Adicione uma camada extra de segurança à sua conta usando 2FA"})]}),s.error&&e.jsxs("div",{className:"mb-6 p-4 bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400 rounded-lg flex items-start gap-3",children:[e.jsx(y,{className:"h-5 w-5 flex-shrink-0 mt-0.5"}),e.jsx("p",{children:s.error})]}),f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-2xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-lg bg-green-200 dark:bg-green-900/40",children:e.jsx(F,{className:"h-6 w-6 text-green-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900 dark:text-green-100 mb-2",children:"2FA Ativado"}),e.jsx("p",{className:"text-green-700 dark:text-green-200 mb-4",children:"Sua conta está protegida com autenticação de dois fatores."}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-300",children:["Recovery codes restantes: ",e.jsx("span",{className:"font-bold",children:c})]})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Recovery Codes"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4 text-sm",children:"Se perder acesso ao seu autenticador, use esses códigos para acessar sua conta. Cada código pode ser usado uma única vez."}),e.jsx("button",{onClick:()=>w(!x),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors mb-4",children:x?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4"}),"Ocultar Códigos"]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"h-4 w-4"}),"Mostrar Códigos"]})}),x&&e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-4 mb-4 font-mono text-sm space-y-2",children:c===0?e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Todos os recovery codes foram utilizados. Gere novos códigos abaixo."}):e.jsxs("p",{className:"text-gray-600 dark:text-gray-400 mb-3",children:["Você tem ",c," código(s) restante(s)."]})}),e.jsx("button",{onClick:()=>{alert("Função em desenvolvimento")},className:"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Gerar Novos Recovery Codes"})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-2xl p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-red-900 dark:text-red-100 mb-4",children:"Desativar 2FA"}),e.jsx("p",{className:"text-red-700 dark:text-red-200 mb-4 text-sm",children:"Desativar 2FA reduzirá a segurança de sua conta. Digite sua senha para confirmar."}),e.jsx("input",{type:"password",value:n,onChange:r=>u(r.target.value),placeholder:"Sua senha",className:"w-full px-4 py-2 border border-red-300 dark:border-red-700 rounded-lg dark:bg-red-900/20 dark:text-white mb-4 focus:outline-none focus:ring-2 focus:ring-red-500"}),e.jsx("button",{onClick:C,disabled:h||!n,className:"w-full px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:h?"Desativando...":"Desativar 2FA"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-2xl p-6 mb-6",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-center h-10 w-10 rounded-lg bg-yellow-200 dark:bg-yellow-900/40",children:e.jsx(y,{className:"h-6 w-6 text-yellow-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-900 dark:text-yellow-100 mb-2",children:"2FA Não Ativado"}),e.jsx("p",{className:"text-yellow-700 dark:text-yellow-200",children:"Proteja sua conta ativando autenticação de dois fatores."})]})]})}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4",children:"Ativar 2FA"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Você precisará de um aplicativo autenticador como Google Authenticator, Microsoft Authenticator ou Authy."}),e.jsx("button",{onClick:v,disabled:s.step!=="idle",className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-semibold",children:s.step==="generating"?"Gerando QR Code...":"Ativar 2FA"})]})]}),j&&s.secret&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full",children:s.step==="confirming"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Recovery Codes"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Salve esses códigos em local seguro. Você precisará deles se perder acesso ao seu autenticador."}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-4 mb-6 font-mono text-sm space-y-2 max-h-48 overflow-y-auto",children:g.map((r,t)=>e.jsx("div",{className:"text-gray-800 dark:text-gray-200",children:r},t))}),e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(g.join(`
`))},className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 mb-3 transition-colors",children:[e.jsx(T,{className:"h-4 w-4"}),"Copiar Códigos"]}),e.jsx("button",{onClick:k,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Entendo, Continuar"})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Escanear QR Code"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Abra seu aplicativo autenticador e escaneie este código."}),s.qrCodeUrl&&e.jsx("div",{className:"bg-white p-4 rounded-lg mb-6 flex justify-center",children:e.jsx("img",{src:s.qrCodeUrl,alt:"QR Code",className:"w-64 h-64"})}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[e.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2",children:"Ou insira manualmente:"}),e.jsx("p",{className:"font-mono text-sm text-gray-900 dark:text-white break-all",children:s.secret})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Código de Verificação (6 dígitos)"}),e.jsx("input",{type:"text",value:d,onChange:r=>i(r.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"000000",maxLength:6,className:"w-full px-4 py-2 text-center text-2xl tracking-widest border border-gray-300 dark:border-gray-600 rounded-lg dark:bg-gray-700 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{m(!1),a({secret:null,qrCodeUrl:null,step:"idle",error:null}),i("")},className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:N,disabled:s.step==="verifying"||d.length!==6,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:s.step==="verifying"?"Verificando...":"Verificar"})]})]})})})})]})})}export{Se as default};
