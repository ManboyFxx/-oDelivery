import{r as j,u as v,j as e,H as M,e as h}from"./app-B_J8lkvq.js";import{A as B,U as E}from"./AuthenticatedLayout-DKdP690n.js";import{I as s}from"./InputLabel-DgCzgfTB.js";import{T as o}from"./TextInput-CF_NLL-i.js";import{P as N}from"./PrimaryButton-yomEzznH.js";import{S as F}from"./SecondaryButton-DwxEYMC-.js";import{M as q}from"./Modal-C-bZLru0.js";import{P as G}from"./PageHeader-DB876WB8.js";import{P as g}from"./plus-B3HQxRgD.js";import{H as u}from"./history-RlN_G7ea.js";import{S as $}from"./settings-Bjd1EFRI.js";import{A as H}from"./arrow-down-left-xSFxuAvj.js";import{A as w}from"./arrow-up-right-xtyZboFe.js";import{G as L}from"./gift-CCHvs5L8.js";import{T as O}from"./trash-2-DC9jLvpP.js";import{S as U}from"./save-nyUg9hUn.js";import{t as V}from"./switch-C3fnJxal.js";import"./shopping-bag-DaPSf6TI.js";import"./package-CeHhWqUy.js";import"./layout-dashboard-DDvXwa6l.js";import"./credit-card-hB9Iy1G8.js";import"./trophy-CpSHVSLI.js";import"./chart-column-DlQMyJ49.js";import"./ticket-DBNRMPVC.js";import"./store-azgh8etq.js";import"./dollar-sign-DExvMb2d.js";import"./key-Wmv6-h3t.js";import"./shield-check-2o4NXgtW.js";import"./log-out-BCw83gpS.js";import"./transition-DR1ycciu.js";import"./use-sync-refs-D78moVXV.js";import"./truck-CuKP95K_.js";import"./menu-BcHp92a-.js";import"./use-resolve-button-type-LJuoFKDT.js";import"./keyboard-C8TFH4Q7.js";import"./portal-CNpUkHpF.js";import"./with-selector-FY2Gi7hl.js";import"./chevron-down-NvgkGDYJ.js";import"./clock-DD5LZAZg.js";import"./menu-COef93TY.js";import"./search-BGAmxcu_.js";import"./bell-DhFf-dhR.js";import"./eye-C1y5PipQ.js";import"./arrow-left-DhEioSnZ.js";import"./hidden-DWZmHSJq.js";function Fe({settings:i,history:y,customers:_}){const[d,b]=j.useState("dashboard"),[k,c]=j.useState(!1),{data:a,setData:r,post:C,processing:A}=v({loyalty_enabled:i?.loyalty_enabled??!1,points_per_currency:i?.points_per_currency??1,currency_per_point:i?.currency_per_point??.1,loyalty_expiry_days:i?.loyalty_expiry_days??null,referral_bonus_points:i?.referral_bonus_points??0,referral_reward_points:i?.referral_reward_points??0,loyalty_tiers:i?.loyalty_tiers??[{name:"Bronze",min_points:0,multiplier:1},{name:"Prata",min_points:100,multiplier:1.05},{name:"Ouro",min_points:500,multiplier:1.1},{name:"Diamante",min_points:1e3,multiplier:1.15}]}),D=t=>{t.preventDefault(),C(route("loyalty.settings"))},{data:x,setData:m,post:S,processing:P,reset:R,errors:f}=v({customer_id:"",points:"",type:"add",description:"Ajuste manual"}),T=t=>{t.preventDefault(),S(route("loyalty.adjust"),{onSuccess:()=>{c(!1),R()}})};return e.jsxs(B,{children:[e.jsx(M,{title:"Fidelidade"}),e.jsxs("div",{className:"flex h-full flex-col space-y-8",children:[e.jsx(G,{title:"Programa de Fidelidade",subtitle:"Gerencie pontos, recompensas e configurações.",action:d==="dashboard"?e.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 rounded-2xl bg-[#ff3d03] px-6 py-3 text-sm font-bold text-white shadow-lg shadow-[#ff3d03]/20 hover:bg-[#e63700] hover:scale-105 active:scale-95 transition-all whitespace-nowrap",children:[e.jsx(g,{className:"h-5 w-5"}),"Ajuste Manual"]}):void 0}),e.jsx("div",{className:"flex justify-center md:justify-start",children:e.jsxs("nav",{className:"flex items-center gap-1 bg-white dark:bg-[#1a1b1e] p-1.5 rounded-2xl border border-gray-100 dark:border-white/5 shadow-sm",children:[e.jsxs("button",{onClick:()=>b("dashboard"),className:h("px-6 py-2.5 rounded-xl text-sm font-bold transition-all whitespace-nowrap flex items-center gap-2",d==="dashboard"?"bg-[#ff3d03] text-white shadow-md shadow-[#ff3d03]/20":"text-gray-500 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-white/5"),children:[e.jsx(u,{className:"h-4 w-4"}),"Visão Geral"]}),e.jsxs("button",{onClick:()=>b("settings"),className:h("px-6 py-2.5 rounded-xl text-sm font-bold transition-all whitespace-nowrap flex items-center gap-2",d==="settings"?"bg-[#ff3d03] text-white shadow-md shadow-[#ff3d03]/20":"text-gray-500 hover:text-gray-900 dark:hover:text-white hover:bg-gray-50 dark:hover:bg-white/5"),children:[e.jsx($,{className:"h-4 w-4"}),"Configurações"]})]})}),e.jsxs("div",{children:[d==="dashboard"&&e.jsx("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsxs("div",{className:"bg-white dark:bg-[#1a1b1e] rounded-[32px] shadow-xl shadow-gray-200/50 dark:shadow-none border border-gray-100 dark:border-white/5 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 dark:border-white/5 flex justify-between items-center",children:e.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Últimas Movimentações"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-[#0f1012] text-gray-500 dark:text-gray-400 uppercase text-xs font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 rounded-tl-[32px]",children:"Cliente"}),e.jsx("th",{className:"px-6 py-4",children:"Tipo"}),e.jsx("th",{className:"px-6 py-4",children:"Pontos"}),e.jsx("th",{className:"px-6 py-4",children:"Descrição"}),e.jsx("th",{className:"px-6 py-4 rounded-tr-[32px]",children:"Data"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-white/5",children:[y.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-900 dark:text-white",children:t.customer.name}),e.jsx("td",{className:"px-6 py-4",children:t.type==="earn"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 text-green-600 bg-green-50 dark:bg-green-500/10 px-3 py-1 rounded-lg text-xs font-bold border border-green-100 dark:border-green-500/20",children:[e.jsx(H,{className:"h-3 w-3"})," Acúmulo"]}):e.jsxs("span",{className:"inline-flex items-center gap-1.5 text-red-600 bg-red-50 dark:bg-red-500/10 px-3 py-1 rounded-lg text-xs font-bold border border-red-100 dark:border-red-500/20",children:[e.jsx(w,{className:"h-3 w-3"})," Resgate"]})}),e.jsxs("td",{className:h("px-6 py-4 font-black text-lg",t.type==="earn"?"text-green-600":"text-red-500"),children:[t.type==="earn"?"+":"-",t.points]}),e.jsx("td",{className:"px-6 py-4 text-gray-500 dark:text-gray-400",children:t.description}),e.jsxs("td",{className:"px-6 py-4 text-gray-400 dark:text-gray-500 text-xs font-medium",children:[new Date(t.created_at).toLocaleDateString("pt-BR")," às ",new Date(t.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})]})]},t.id)),y.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"px-6 py-20 text-center text-gray-500 dark:text-gray-400 flex flex-col items-center justify-center w-full",children:[e.jsx("div",{className:"h-16 w-16 bg-gray-50 dark:bg-white/5 rounded-full flex items-center justify-center mb-4",children:e.jsx(u,{className:"h-8 w-8 text-gray-300"})}),e.jsx("p",{className:"font-bold text-gray-900 dark:text-white",children:"Nenhuma movimentação registrada."})]})})]})]})})]})}),d==="settings"&&e.jsx("div",{className:"max-w-4xl space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsx("div",{className:"bg-white dark:bg-[#1a1b1e] rounded-[32px] shadow-xl shadow-gray-200/50 dark:shadow-none border border-gray-100 dark:border-white/5 p-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-2xl bg-orange-50 dark:bg-orange-900/20 flex items-center justify-center text-[#ff3d03]",children:e.jsx(L,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Programa de Fidelidade"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Ative para permitir que seus clientes acumulem pontos."})]})]}),e.jsx(V,{checked:a.loyalty_enabled,onChange:t=>r("loyalty_enabled",t),className:`${a.loyalty_enabled?"bg-[#ff3d03]":"bg-gray-300 dark:bg-gray-600"} relative inline-flex h-7 w-12 items-center rounded-full transition-colors focus:outline-none`,children:e.jsx("span",{className:`${a.loyalty_enabled?"translate-x-6":"translate-x-1"} inline-block h-5 w-5 transform rounded-full bg-white transition-transform`})})]})}),e.jsxs("div",{className:"bg-white dark:bg-[#1a1b1e] rounded-[32px] shadow-xl shadow-gray-200/50 dark:shadow-none border border-gray-100 dark:border-white/5 p-8",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6",children:"Regras de Pontuação"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Pontos por Real Gasto",className:"mb-2"}),e.jsxs("div",{className:"relative group",children:[e.jsx(o,{type:"number",value:a.points_per_currency,onChange:t=>r("points_per_currency",parseFloat(t.target.value)),className:"w-full pr-16 h-14 text-lg font-bold",step:"0.1",min:"0"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400 font-bold bg-transparent",children:"pts / R$"})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2 pl-1",children:["Ex: O cliente ganha ",e.jsx("strong",{className:"text-gray-900 dark:text-white",children:"1 ponto"})," a cada R$ 1,00 gasto."]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Valor do CashBack (Resgate)",className:"mb-2"}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-4 pointer-events-none text-gray-400 font-bold",children:"R$"}),e.jsx(o,{type:"number",value:a.currency_per_point,onChange:t=>r("currency_per_point",parseFloat(t.target.value)),className:"w-full pl-10 pr-16 h-14 text-lg font-bold",step:"0.01",min:"0"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400 font-bold",children:"/ ponto"})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2 pl-1",children:["Ex: Cada ponto vale ",e.jsx("strong",{className:"text-gray-900 dark:text-white",children:"R$ 0,10"})," de desconto."]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8 pt-6 border-t border-gray-100 dark:border-white/5",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(u,{className:"h-4 w-4 text-orange-500"}),e.jsx(s,{value:"Validade dos Pontos (Dias)"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(o,{type:"number",value:a.loyalty_expiry_days??"",onChange:t=>r("loyalty_expiry_days",t.target.value?parseInt(t.target.value):null),className:"w-full pr-16 h-14 text-lg font-bold",placeholder:"Ex: 90",min:"1"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400 font-bold bg-transparent",children:"dias"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2 pl-1",children:"Deixe em branco para pontos nunca expirarem."})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"h-4 w-4 text-blue-500"}),e.jsx(s,{value:"Bônus por Indicação (Indique e Ganhe)"})]}),e.jsxs("div",{className:"relative group",children:[e.jsx(o,{type:"number",value:a.referral_bonus_points,onChange:t=>r("referral_bonus_points",parseInt(t.target.value)||0),className:"w-full pr-16 h-14 text-lg font-bold",placeholder:"0",min:"0"}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-4 pointer-events-none text-gray-400 font-bold bg-transparent",children:"pts"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2 pl-1",children:"Pontos que o cliente ganha ao indicar um amigo que comprar."})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-bold text-gray-900 dark:text-white",children:"Níveis de Fidelidade (Ranking)"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Defina os nomes e pontuações para cada nível."})]}),e.jsxs("button",{type:"button",onClick:()=>{const t=a.loyalty_tiers||[];r("loyalty_tiers",[...t,{name:"Novo Nível",min_points:0,multiplier:1}])},className:"text-sm font-bold text-[#ff3d03] hover:text-[#e63700] flex items-center gap-1",children:[e.jsx(g,{className:"h-4 w-4"})," Adicionar Nível"]})]}),e.jsxs("div",{className:"space-y-3",children:[a.loyalty_tiers?.map((t,p)=>e.jsxs("div",{className:"flex gap-4 items-end bg-gray-50 dark:bg-white/5 p-4 rounded-2xl border border-gray-100 dark:border-white/5 group",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(s,{value:"Nome do Nível",className:"mb-1 text-xs"}),e.jsx(o,{value:t.name,onChange:n=>{const l=[...a.loyalty_tiers];l[p].name=n.target.value,r("loyalty_tiers",l)},className:"w-full h-10 text-sm font-bold",placeholder:"Ex: Diamante"})]}),e.jsxs("div",{className:"w-32",children:[e.jsx(s,{value:"Min. Pontos",className:"mb-1 text-xs"}),e.jsx(o,{type:"number",value:t.min_points,onChange:n=>{const l=[...a.loyalty_tiers];l[p].min_points=parseInt(n.target.value)||0,r("loyalty_tiers",l)},className:"w-full h-10 text-sm font-bold"})]}),e.jsxs("div",{className:"w-24",children:[e.jsx(s,{value:"Multiplicador",className:"mb-1 text-xs"}),e.jsx(o,{type:"number",step:"0.05",value:t.multiplier,onChange:n=>{const l=[...a.loyalty_tiers];l[p].multiplier=parseFloat(n.target.value)||1,r("loyalty_tiers",l)},className:"w-full h-10 text-sm font-bold"})]}),e.jsx("button",{type:"button",onClick:()=>{const n=a.loyalty_tiers.filter((l,I)=>I!==p);r("loyalty_tiers",n)},className:"h-10 w-10 flex items-center justify-center rounded-xl text-gray-400 hover:text-red-500 hover:bg-red-50 transition-colors",children:e.jsx(O,{className:"h-5 w-5"})})]},p)),(!a.loyalty_tiers||a.loyalty_tiers.length===0)&&e.jsx("p",{className:"text-center text-gray-500 py-4 italic",children:"Nenhum nível configurado. Adicione um para começar."})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs(N,{disabled:A,className:"h-12 px-8 rounded-xl bg-[#ff3d03] hover:bg-[#e63700] shadow-lg shadow-[#ff3d03]/20 border-transparent text-base font-bold",children:[e.jsx(U,{className:"h-5 w-5 mr-2"}),"Salvar Configurações"]})})]})})]})]}),e.jsx(q,{show:k,onClose:()=>c(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 dark:text-white",children:"Ajuste Manual de Pontos"}),e.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600"})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(s,{value:"Cliente"}),e.jsxs("select",{value:x.customer_id,onChange:t=>m("customer_id",t.target.value),className:"w-full mt-1 border-gray-200 dark:border-gray-700 bg-white dark:bg-[#0f1012] text-gray-900 dark:text-white focus:border-[#ff3d03] focus:ring-[#ff3d03] rounded-xl h-12 shadow-sm",required:!0,children:[e.jsx("option",{value:"",children:"Selecione um cliente..."}),_.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.loyalty_points," pts atuais)"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Tipo de Operação"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-1",children:[e.jsxs("button",{type:"button",onClick:()=>m("type","add"),className:h("flex items-center justify-center gap-2 py-3 px-4 rounded-xl border font-bold transition-all relative overflow-hidden",x.type==="add"?"bg-green-500 text-white border-green-500 shadow-md transform scale-[1.02]":"border-gray-200 text-gray-500 bg-gray-50 hover:bg-gray-100 dark:border-gray-700 dark:bg-white/5 dark:text-gray-400"),children:[e.jsx(g,{className:"h-5 w-5"})," Adicionar"]}),e.jsxs("button",{type:"button",onClick:()=>m("type","remove"),className:h("flex items-center justify-center gap-2 py-3 px-4 rounded-xl border font-bold transition-all relative overflow-hidden",x.type==="remove"?"bg-red-500 text-white border-red-500 shadow-md transform scale-[1.02]":"border-gray-200 text-gray-500 bg-gray-50 hover:bg-gray-100 dark:border-gray-700 dark:bg-white/5 dark:text-gray-400"),children:[e.jsx(w,{className:"h-5 w-5"})," Remover"]})]})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Quantidade de Pontos"}),e.jsx(o,{type:"number",value:x.points,onChange:t=>m("points",t.target.value),className:"w-full mt-1 h-12 font-bold text-lg",min:"1",placeholder:"0",required:!0}),f.points&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:f.points})]}),e.jsxs("div",{children:[e.jsx(s,{value:"Motivo / Descrição"}),e.jsx(o,{type:"text",value:x.description,onChange:t=>m("description",t.target.value),className:"w-full mt-1 h-12",placeholder:"Ex: Bônus de aniversário",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-100 dark:border-white/5",children:[e.jsx(F,{onClick:()=>c(!1),className:"h-12 px-6 rounded-xl",children:"Cancelar"}),e.jsx(N,{disabled:P,className:"h-12 px-6 rounded-xl bg-[#ff3d03] hover:bg-[#e63700] border-transparent shadow-lg shadow-[#ff3d03]/20",children:"Confirmar Ajuste"})]})]})]})})]})}export{Fe as default};
