import{r as s,g as le,j as t,H as ce,d as D}from"./app-DStU8MwD.js";import{u as de}from"./usePushNotifications-DPgYwf5r.js";import{t as m}from"./index-BpbV1GNr.js";import me from"./HeroSection-DW4SrUz2.js";import ue from"./CategoryNav-D2gOPm2Q.js";import pe from"./ProductGrid-yUDHQJMo.js";import fe from"./CartSidebar-D0FGV02u.js";import he from"./StoreInfoModal-DuOfhe-j.js";import xe from"./ProductModal-Bv57fBil.js";import ge from"./AuthModal-pQqjDG8n.js";import we from"./CustomerAreaModal-DMDOzAe1.js";import ve from"./CheckoutModal-_WeM8Yq3.js";import je from"./MenuNavbar-CUPdU4sh.js";import Se from"./FeaturedProductCard-DASoPp3S.js";import{F as be}from"./flame-Cou2Y8JI.js";import"./search-DEuGphhN.js";import"./sun-Bzc8mG1J.js";import"./instagram-CH7XXoPs.js";import"./message-circle-Bnnb_Q0c.js";import"./map-pin-C7UZyu0W.js";import"./ProductCard-DeVX1a2v.js";import"./plus-BKUIj5vD.js";import"./shopping-bag-DWef1FNa.js";import"./pen-DXWnotp3.js";import"./trash-2-BqMSKMt8.js";import"./minus-BLV6hl6T.js";import"./chevron-right-B_2chNzF.js";import"./clock-Dh7Of57R.js";import"./star-BnEWWDQh.js";import"./navigation-tlO4kTTv.js";import"./share-2-DDlV9Go1.js";import"./AddressForm-aehpdn5A.js";import"./TextInput-eH8abxMg.js";import"./InputLabel-Bd7kPWfd.js";import"./PrimaryButton-BGPXm-XG.js";import"./SecondaryButton-SeRsFzXR.js";import"./loader-circle-B1H6wIrX.js";import"./bell-CX96QJqb.js";import"./gift-CzuabP92.js";import"./trophy-BlNa_V_6.js";import"./log-out-j4Bx4tDQ.js";import"./house-BqJNw-7I.js";import"./check-45U1Zexh.js";import"./history-BkUDSnLI.js";import"./copy-DNNxWaep.js";import"./Modal-DTlkYVpv.js";import"./keyboard-B40p_ba_.js";import"./use-sync-refs-DFFshV1K.js";import"./portal-yErZUvIx.js";import"./with-selector-DKWJKT3r.js";import"./hidden-DR4F-w76.js";import"./transition-DKZ_I0YA.js";import"./sparkles-Cso61yRr.js";import"./arrow-left-BJHQYbU1.js";import"./circle-check-big-2jZeH2Kn.js";import"./wallet-DrzP41gl.js";import"./ticket-DQoQd_m4.js";import"./credit-card-B7I-2Gye.js";import"./banknote-BbZphLaa.js";import"./switch-Db9cnu65.js";import"./use-resolve-button-type-tIJiKY6f.js";import"./store-DuSO3jdq.js";import"./user-qTY3yEcW.js";function F(r,i){r=r.replace(/^#/,"");let c=parseInt(r.substring(0,2),16),l=parseInt(r.substring(2,4),16),u=parseInt(r.substring(4,6),16);c=Math.floor(c*(1+i/100)),l=Math.floor(l*(1+i/100)),u=Math.floor(u*(1+i/100)),c=Math.min(255,Math.max(0,c)),l=Math.min(255,Math.max(0,l)),u=Math.min(255,Math.max(0,u));const N=c.toString(16).padStart(2,"0"),p=l.toString(16).padStart(2,"0"),S=u.toString(16).padStart(2,"0");return`#${N}${p}${S}`}function _t({store:r,categories:i,slug:c,authCustomer:l,activePromotion:u,availableCoupons:N}){de(l);const[p,S]=s.useState("all"),[b,V]=s.useState(""),[d,f]=s.useState([]),[B,O]=s.useState(null),[E,w]=s.useState(!1),[L,_]=s.useState(null),[U,P]=s.useState(null),[C,h]=s.useState(!1),[A,y]=s.useState(!1),[k,v]=s.useState(!1),[j,x]=s.useState(!1);s.useEffect(()=>{if(typeof window<"u"){const o=new URLSearchParams(window.location.search).get("ref");o&&localStorage.setItem("referral_code",o)}},[]);const[a,T]=s.useState(l),[J,H]=s.useState([]),[M,Q]=s.useState(()=>{const e=localStorage.getItem("menu_theme");return e?e==="dark":r.theme_mode==="dark"?!0:r.theme_mode==="light"?!1:window.matchMedia("(prefers-color-scheme: dark)").matches}),G=()=>{Q(e=>{const o=!e;return localStorage.setItem("menu_theme",o?"dark":"light"),o})},W=async()=>{if(a)try{const e=await D.get("/customer/addresses");H(e.data)}catch(e){console.error("Error loading addresses:",e)}};s.useEffect(()=>{a?W():H([])},[a]);const{play:Y,initializeAudio:$}=le();s.useEffect(()=>{const e=()=>$();return window.addEventListener("click",e,{once:!0}),window.addEventListener("touchstart",e,{once:!0}),()=>{window.removeEventListener("click",e),window.removeEventListener("touchstart",e)}},[$]),s.useEffect(()=>{const e=localStorage.getItem("cart");if(e)try{f(JSON.parse(e))}catch(o){console.error("Error parsing cart",o)}},[]),s.useEffect(()=>{localStorage.setItem("cart",JSON.stringify(d))},[d]),s.useEffect(()=>{const e=window.document.documentElement;M?e.classList.add("dark"):e.classList.remove("dark")},[M]),s.useEffect(()=>{const e=()=>{};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[i]);const K=e=>{if(S(e),e!=="all"){const o=document.getElementById(e);if(o){const n=o.getBoundingClientRect().top+window.scrollY-120;window.scrollTo({top:n,behavior:"smooth"})}}else window.scrollTo({top:0,behavior:"smooth"})},z=e=>{if(!r.is_open){m.error("Desculpe, a loja está fechada no momento.");return}O(e),P(null),_(null),w(!0)},X=e=>{L!==null?(f(o=>o.map((g,n)=>n===L?e:g)),m.success("Item atualizado com sucesso!")):(f(o=>[...o,e]),m.success("Adicionado ao carrinho!"),Y("success")),w(!1)},Z=e=>{const o=d[e];O(o.product),P(o),_(e),w(!0),h(!1)},ee=e=>{f(o=>o.filter((g,n)=>n!==e)),m.info("Item removido do carrinho.")},te=()=>{if(!r.is_open){m.error("Desculpe, a loja está fechada para novos pedidos.");return}if(!a){m.info("Para finalizar, indentifique-se primeiro."),v(!0),h(!1);return}I(!0),h(!1)},[R,I]=s.useState(!1),oe=e=>{T(e)},re=async()=>{try{await D.post("/customer/logout"),T(null),m.info("Você saiu da conta."),x(!1)}catch(e){console.error(e)}},se=d.reduce((e,o)=>e+o.subtotal,0),q=d.reduce((e,o)=>e+o.quantity,0),ae=(e,o)=>{o<1||f(g=>g.map((n,ne)=>{if(ne===e){const ie=n.subtotal/n.quantity;return{...n,quantity:o,subtotal:ie*o}}return n}))};return t.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-premium-dark text-gray-900 dark:text-gray-100 font-sans selection:bg-orange-100 selection:text-orange-900 pb-40 md:pb-40 transition-colors duration-300",children:[t.jsx(ce,{title:r.name,children:t.jsx("style",{children:`
                    :root {
                        --primary-color: ${r.theme_color||"#ff3d03"};
                        --primary-hover: ${F(r.theme_color||"#ff3d03",-10)};
                        --primary-active: ${F(r.theme_color||"#ff3d03",-20)};
                    }
                `})}),t.jsx(me,{store:r,customer:a,onOpenAuth:()=>v(!0),onOpenProfile:()=>x(!0),onOpenCart:()=>h(!0),onOpenInfo:()=>y(!0),cartCount:q,searchQuery:b,setSearchQuery:V,isDark:M,toggleTheme:G}),!b&&p==="all"&&i.some(e=>e.products.some(o=>o.is_featured))&&t.jsx("section",{className:"max-w-7xl mx-auto px-4 md:px-8 py-8",children:t.jsxs("div",{className:"mb-6 flex flex-col items-center",children:[t.jsxs("div",{className:"flex items-center justify-center gap-3",children:[t.jsx("div",{className:"h-10 w-10 rounded-xl bg-gradient-to-br from-orange-500 to-red-500 text-white flex items-center justify-center rotate-3 shadow-lg",children:t.jsx(be,{className:"h-5 w-5"})}),t.jsx("div",{children:t.jsx("h2",{className:"text-xl md:text-2xl font-black text-gray-900 dark:text-white tracking-tight text-center",children:"Melhores da casa"})})]}),t.jsx("div",{className:"flex flex-wrap justify-center gap-6 md:gap-8 mt-10",children:i.flatMap(e=>e.products).filter(e=>e.is_featured).map(e=>t.jsx(Se,{product:e,onAdd:z,isStoreOpen:r.is_open},e.id))})]})}),t.jsx(ue,{categories:i,activeCategory:p,onSelectCategory:K}),!r.is_open&&t.jsx("div",{className:"max-w-7xl mx-auto px-4 mt-6",children:t.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800/50 rounded-2xl p-4 flex items-center justify-center gap-3 text-red-600 dark:text-red-400",children:[t.jsx("svg",{className:"w-5 h-5 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),t.jsx("span",{className:"font-bold text-sm md:text-base",children:"Loja Fechada. Pedidos temporariamente indisponíveis."})]})}),t.jsx("main",{children:t.jsx("div",{className:"flex flex-col md:flex-row max-w-7xl mx-auto items-start gap-6",children:t.jsx("div",{className:"flex-1 w-full",children:t.jsx(pe,{categories:i.map(e=>({...e,products:e.products.filter(o=>o.name.toLowerCase().includes(b.toLowerCase())&&(p==="all"||e.id===p))})).filter(e=>e.products.length>0),onAdd:z,viewMode:r.menu_view_mode||"grid",isStoreOpen:r.is_open})})})}),t.jsx(fe,{isOpen:C,onClose:()=>h(!1),cart:d,onUpdateQuantity:ae,onEdit:Z,onRemove:ee,onCheckout:te}),t.jsx(he,{isOpen:A,onClose:()=>y(!1),store:r}),E&&t.jsx(xe,{product:B,isOpen:E,onClose:()=>w(!1),onAddToCart:X,initialValues:U}),k&&t.jsx(ge,{isOpen:k,onClose:()=>v(!1),onLogin:oe,slug:c}),j&&t.jsx(we,{isOpen:j,onClose:()=>x(!1),customer:a,onLogout:re,store:r}),R&&t.jsx(ve,{show:R,onClose:()=>I(!1),cart:d,customer:a,store:r,total:se,addresses:J,onSuccess:()=>{f([]),I(!1)}}),a&&!C&&!j&&t.jsx("div",{className:"fixed top-4 right-4 z-40 hidden md:block",children:t.jsxs("button",{onClick:()=>x(!0),className:"bg-white px-4 py-2 rounded-full shadow-lg border border-gray-100 flex items-center gap-2 hover:bg-gray-50 transition-colors",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center text-primary font-bold text-xs uppercase",children:a.name.substring(0,2)}),t.jsx("span",{className:"font-bold text-gray-700 text-sm",children:a.name.split(" ")[0]})]})}),t.jsx(je,{customer:a,cartCount:q,onHome:()=>window.scrollTo({top:0,behavior:"smooth"}),onAccount:()=>{a?x(!0):v(!0)},onStore:()=>y(!0),onCart:()=>h(!0),activeTab:C?"cart":j||k?"account":A?"store":"home"})]})}export{_t as default};
