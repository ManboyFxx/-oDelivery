import{c as rt,r as d,j as e,e as i,b as at,u as qe,d as Ee,H as lt,X as M,a as q}from"./app-DStU8MwD.js";import{A as dt}from"./AuthenticatedLayout-DbMMfPc0.js";import{M as xe}from"./Modal-DTlkYVpv.js";import{I as me}from"./InputLabel-Bd7kPWfd.js";import{T as Pe}from"./TextInput-eH8abxMg.js";import{P as ot}from"./PrimaryButton-BGPXm-XG.js";import{U as Ae}from"./user-qTY3yEcW.js";import{S as ze}from"./search-DEuGphhN.js";import{C as ue}from"./check-45U1Zexh.js";import{S}from"./shopping-cart-DlAzvhM7.js";import{L as K}from"./layout-grid-BrQoJ1B6.js";import{I as he}from"./image-DoN3fn7u.js";import{P as T}from"./plus-BKUIj5vD.js";import{M as Y}from"./minus-BLV6hl6T.js";import{U as be}from"./users-yPlFTsXt.js";import{T as nt}from"./trash-2-BqMSKMt8.js";import{C as ge}from"./circle-alert-BVgghJlp.js";import{B as Oe}from"./banknote-BbZphLaa.js";import{C as it}from"./credit-card-B7I-2Gye.js";import{Q as ct}from"./qr-code-B4bjK4_M.js";import{L as xt}from"./loader-circle-B1H6wIrX.js";import"./monitor-BxyGoWP4.js";import"./shopping-bag-DWef1FNa.js";import"./package-DTP_tjtl.js";import"./layout-dashboard-lVxcZVl0.js";import"./trophy-BlNa_V_6.js";import"./ticket-DQoQd_m4.js";import"./store-DuSO3jdq.js";import"./dollar-sign-BZpTB1Mz.js";import"./key-SqM6ParG.js";import"./shield-check-CRBnQq9v.js";import"./log-out-j4Bx4tDQ.js";import"./transition-DKZ_I0YA.js";import"./use-sync-refs-DFFshV1K.js";import"./truck-BNo8_dDu.js";import"./switch-Db9cnu65.js";import"./use-resolve-button-type-tIJiKY6f.js";import"./keyboard-B40p_ba_.js";import"./hidden-DR4F-w76.js";import"./menu-B1dGMPu8.js";import"./portal-yErZUvIx.js";import"./with-selector-DKWJKT3r.js";import"./chevron-down-C5vhnEBS.js";import"./clock-Dh7Of57R.js";import"./circle-play-CI0RrttL.js";import"./menu-DBOcVmce.js";import"./sun-Bzc8mG1J.js";import"./bell-CX96QJqb.js";import"./eye-QpiWbMKF.js";import"./arrow-left-BJHQYbU1.js";import"./usePushNotifications-DPgYwf5r.js";import"./zap-CKk3AS2t.js";import"./star-BnEWWDQh.js";import"./chevron-right-B_2chNzF.js";import"./lock-CIamgwxM.js";const mt=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],ht=rt("chevrons-up-down",mt);function Re({customers:$,value:v,onChange:b}){const[E,y]=d.useState(!1),[o,p]=d.useState(""),k=d.useRef(null);d.useEffect(()=>{const n=V=>{k.current&&!k.current.contains(V.target)&&y(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]);const L=o===""?$:$.filter(n=>n.name.toLowerCase().includes(o.toLowerCase())||n.phone.includes(o));return e.jsxs("div",{className:"relative",ref:k,children:[e.jsxs("div",{className:"w-full flex items-center justify-between rounded-lg border border-gray-300 bg-white py-2 pl-3 pr-3 text-sm focus-within:ring-2 focus-within:ring-yellow-500 focus-within:border-yellow-500 cursor-pointer dark:bg-[#2c2d30] dark:border-gray-700 dark:text-white",onClick:()=>y(!E),children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:i("truncate",!v&&"text-gray-400"),children:v?v.name:"Selecionar cliente..."})]}),e.jsx(ht,{className:"h-4 w-4 text-gray-400"})]}),E&&e.jsxs("div",{className:"absolute z-50 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm dark:bg-[#2c2d30] dark:ring-gray-700",children:[e.jsx("div",{className:"sticky top-0 bg-white p-2 border-b dark:bg-[#2c2d30] dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-2 top-1/2 h-3 w-3 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",className:"w-full rounded-md border border-gray-200 bg-gray-50 py-1 pl-7 pr-2 text-xs focus:border-yellow-500 focus:ring-yellow-500 dark:bg-gray-800 dark:border-gray-600 dark:text-white",placeholder:"Buscar nome ou telefone...",value:o,onChange:n=>p(n.target.value),autoFocus:!0})]})}),L.length===0&&e.jsx("div",{className:"relative cursor-default select-none py-2 px-4 text-gray-700 dark:text-gray-400",children:"Nenhum cliente encontrado."}),L.map(n=>e.jsxs("div",{className:i("relative cursor-pointer select-none py-2 pl-3 pr-9 hover:bg-yellow-50 dark:hover:bg-yellow-900/10",v?.id===n.id?"text-yellow-600 bg-yellow-50 dark:text-yellow-500 dark:bg-yellow-900/10":"text-gray-900 dark:text-gray-200"),onClick:()=>{b(n),y(!1),p("")},children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"block truncate font-medium",children:n.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("span",{children:n.phone}),n.loyalty_points!==void 0&&e.jsxs("span",{className:"flex items-center gap-0.5 text-yellow-600 dark:text-yellow-500 font-bold bg-yellow-100 dark:bg-yellow-900/30 px-1 rounded",children:[n.loyalty_points," pts"]})]})]}),v?.id===n.id&&e.jsx("span",{className:"absolute inset-y-0 right-0 flex items-center pr-4 text-yellow-600",children:e.jsx(ue,{className:"h-4 w-4"})})]},n.id)),v&&e.jsx("div",{className:"border-t border-gray-100 dark:border-gray-700 py-2 px-3 text-center text-xs text-red-500 font-medium hover:bg-red-50 dark:hover:bg-red-900/10 cursor-pointer",onClick:()=>{b(null),y(!1)},children:"Remover seleção"})]})]})}function vs({categories:$,allProducts:v,tables:b=[],customers:E=[]}){const{tenant:y}=at().props,[o,p]=d.useState([]),[k,L]=d.useState(""),[n,V]=d.useState("all"),[ee,Q]=d.useState(!1),[De,P]=d.useState(!1),[te,B]=d.useState("sales"),[f,se]=d.useState(null),[m,pe]=d.useState(null),[O,U]=d.useState(1),[fe,re]=d.useState(""),[Z,ae]=d.useState({}),[G,le]=d.useState(null),[j,R]=d.useState(null),[ye,Ie]=d.useState("cash"),[Le,H]=d.useState(!1),{data:je,setData:we,post:Ve,processing:Qe,reset:Be}=qe({number:"",capacity:"4"}),Ue=t=>{t.preventDefault(),Ve(route("tables.store"),{onSuccess:()=>{P(!1),Be()}})},{data:r,setData:g,post:bt,processing:de,reset:ve,errors:Ne}=qe({items:[],customer_name:"",customer_id:"",payment_method:"cash",order_mode:"pickup",total:0,table_id:"",address_street:"",address_number:"",address_neighborhood:"",address_complement:""}),[x,oe]=d.useState(""),[w,A]=d.useState(null),[_,z]=d.useState(null),[ne,ke]=d.useState(!1),[F,D]=d.useState(null),[_e,I]=d.useState(""),[gt,ut]=d.useState(""),[pt,ft]=d.useState(!1),[W,Ze]=d.useState([]);d.useEffect(()=>{ee&&W.length===0&&y?.id&&Ee.get(`/api/delivery-zones?tenant_id=${y.id}`).then(t=>Ze(t.data)).catch(t=>console.error("Error fetching zones:",t))},[ee,y?.id]);const Ge=t=>{pe(t),U(1),re(""),ae({})},Ce=()=>{pe(null),U(1),re(""),ae({})},He=t=>{if(t.complement_groups&&t.complement_groups.length>0){Ge(t);return}p(s=>s.find(a=>a.id===t.id&&!a.selectedComplements)?s.map(a=>a.id===t.id&&!a.selectedComplements?{...a,quantity:a.quantity+1}:a):[...s,{...t,quantity:1}])},We=()=>{if(!m)return;const t=[];Object.entries(Z).forEach(([s,l])=>{Object.entries(l).forEach(([a,c])=>{const u=m.complement_groups?.find(N=>N.id===s)?.options.find(N=>N.id===a);u&&c>0&&t.push({groupId:s,optionId:a,name:u.name,price:u.price,quantity:c})})}),p(s=>[...s,{...m,quantity:O,notes:fe,selectedComplements:t.length>0?t:void 0}]),Ce()},Se=(t,s,l,a,c)=>{ae(h=>{const u=h[t]||{},N=u[s]||0,ie=Math.max(0,Math.min(N+l,a));if(Object.values(u).reduce((tt,st)=>tt+st,0)-N+ie>c)return h;const ce={...u};return ie===0?delete ce[s]:ce[s]=ie,{...h,[t]:ce}})},Me=t=>{const s=Z[t]||{};return Object.values(s).reduce((l,a)=>l+a,0)},Je=()=>{if(!m?.complement_groups)return{valid:!0,message:""};for(const t of m.complement_groups){const s=Me(t.id);if(t.is_required&&s===0)return{valid:!1,message:`"${t.name}" é obrigatório. Selecione pelo menos ${t.min_selections} opção(ões).`};if(s>0&&s<t.min_selections)return{valid:!1,message:`Selecione pelo menos ${t.min_selections} opção(ões) em "${t.name}".`};if(s>t.max_selections)return{valid:!1,message:`Selecione no máximo ${t.max_selections} opção(ões) em "${t.name}".`}}return{valid:!0,message:""}},Xe=()=>{if(!m)return 0;let t=Number(m.price);return m.complement_groups?.forEach(s=>{const l=Z[s.id]||{};Object.entries(l).forEach(([a,c])=>{const h=s.options.find(u=>u.id===a);h&&(t+=h.price*c)})}),t*O},Te=t=>{p(s=>s.filter(l=>l.id!==t))},J=(t,s)=>{p(l=>l.map(a=>{if(a.id===t){const c=Math.max(1,a.quantity+s);return{...a,quantity:c}}return a}))},C=d.useMemo(()=>{const t=o.reduce((l,a)=>{let c=Number(a.price)*a.quantity;if(a.selectedComplements){const h=a.selectedComplements.reduce((u,N)=>u+N.price*N.quantity,0);c+=h*a.quantity}return l+c},0),s=r.order_mode==="delivery"&&_!==!1?F!==null?F:Number(y?.settings?.delivery_fee)||0:0;return t+s},[o,F,r.order_mode,_,y]),Ke=d.useMemo(()=>{let t=n==="all"?v:$.find(s=>s.id===n)?.products||[];if(k){const s=k.toLowerCase();t=t.filter(l=>l.name.toLowerCase().includes(s))}return t},[v,$,n,k]),$e=()=>{o.length!==0&&(g({...r,items:o.map(t=>({id:t.id,quantity:t.quantity,notes:t.notes,complements:t.selectedComplements})),total:C}),Q(!0))},X=t=>{if(t&&t.preventDefault(),r.order_mode==="table"&&!x){alert("Por favor, selecione uma mesa antes de continuar.");return}if(f){q.post(route("tables.addItems",f.id),{items:o.map(s=>({id:s.id,quantity:s.quantity,notes:s.notes,complements:s.selectedComplements}))},{onSuccess:()=>{p([]),se(null),B("tables")}});return}if(r.order_mode==="table"&&x){const s=b.find(l=>l.id===x);if(s&&s.status!=="free"){q.post(route("tables.addItems",s.id),{items:o.map(l=>({id:l.id,quantity:l.quantity,notes:l.notes,complements:l.selectedComplements}))},{onSuccess:()=>{Q(!1),p([]),ve(),A(null),oe("")},onError:l=>{console.error("Add Items Error:",l),alert("Erro ao adicionar itens: "+JSON.stringify(l))}});return}}q.post(route("pdv.store"),{items:o.map(s=>({id:s.id,quantity:s.quantity,notes:s.notes,complements:s.selectedComplements})),customer_name:r.customer_name,customer_id:w?.id||null,payment_method:r.payment_method,order_mode:r.order_mode,total:C,delivery_fee:F,delivery_address:r.order_mode==="delivery"?r.customer_name:null,table_id:r.order_mode==="table"?x:null},{onSuccess:()=>{Q(!1),p([]),ve(),A(null),oe("")},onError:s=>{console.error("Store Order Error:",s)}})},Fe=async t=>{if(!t||r.order_mode!=="delivery"){z(!0),D(null),I("");return}if(!(t.length<3)){ke(!0);try{const s=await Ee.post("/api/validate-delivery-zone",{neighborhood:t,tenant_id:y?.id});s.data.valid?(z(!0),D(s.data.fee),I(s.data.message)):(z(!1),D(null),I(s.data.message))}catch(s){console.error("PDV Zone validation error",s)}finally{ke(!1)}}};d.useEffect(()=>{const t=setTimeout(()=>{r.order_mode==="delivery"&&r.address_neighborhood&&Fe(r.address_neighborhood)},800);return()=>clearTimeout(t)},[r.address_neighborhood,r.order_mode]),d.useEffect(()=>{if(r.order_mode==="delivery"){const t=[r.address_street,r.address_number,r.address_neighborhood,r.address_complement].filter(Boolean).join(", ");g("customer_name",t)}},[r.address_street,r.address_number,r.address_neighborhood,r.address_complement]);const Ye=()=>{j&&confirm(`Fechar conta da mesa ${j.number}?`)&&q.post(route("tables.close",j.id),{payment_method:ye},{onSuccess:()=>R(null)})},et=t=>{t.preventDefault(),G&&q.post(route("pdv.store"),{order_mode:"table",table_id:G.id,customer_id:w?.id||null,customer_name:w?.name||"",items:[],payment_method:null},{onSuccess:()=>{le(null),A(null)}})};return e.jsxs(dt,{children:[e.jsx(lt,{title:"PDV"}),e.jsxs("div",{className:"flex flex-col h-[calc(100vh-65px)] overflow-hidden bg-gray-50 dark:bg-[#0f1012]",children:[e.jsxs("div",{className:"bg-white dark:bg-[#1a1b1e] border-b border-gray-100 dark:border-white/5 px-4 py-3 flex items-center justify-between shrink-0 shadow-sm z-20",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("h1",{className:"text-xl font-black text-gray-900 dark:text-white tracking-tight hidden md:block",children:["PDV ",e.jsx("span",{className:"text-[#ff3d03]",children:"."})]}),e.jsxs("div",{className:"flex bg-gray-100 dark:bg-black/20 p-1 rounded-xl",children:[e.jsxs("button",{onClick:()=>B("sales"),className:i("px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wide flex items-center gap-2 transition-all",te==="sales"?"bg-white dark:bg-[#ff3d03] text-gray-900 dark:text-white shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"),children:[e.jsx(S,{className:"h-4 w-4"}),"Caixa"]}),e.jsxs("button",{onClick:()=>B("tables"),className:i("px-4 py-2 rounded-lg text-xs font-bold uppercase tracking-wide flex items-center gap-2 transition-all",te==="tables"?"bg-white dark:bg-[#ff3d03] text-gray-900 dark:text-white shadow-sm ring-1 ring-black/5":"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200"),children:[e.jsx(K,{className:"h-4 w-4"}),"Mesas"]})]})]}),e.jsx("div",{className:"flex items-center gap-2"})]}),te==="sales"?e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col border-r border-gray-200 dark:border-white/5 bg-gray-50 dark:bg-[#0f1012]",children:[e.jsxs("div",{className:"p-4 bg-white dark:bg-[#1a1b1e] border-b border-gray-100 dark:border-white/5 space-y-4 shadow-sm z-10",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ze,{className:"absolute left-4 top-1/2 h-5 w-5 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar produto por nome ou código...",value:k,onChange:t=>L(t.target.value),className:"w-full h-12 rounded-2xl border-none bg-gray-100 dark:bg-black/20 py-3 pl-12 text-gray-900 placeholder:text-gray-500 focus:ring-2 focus:ring-[#ff3d03]/20 dark:text-white transition-all shadow-inner"})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto pb-1 scrollbar-hide",children:[e.jsx("button",{onClick:()=>V("all"),className:i("whitespace-nowrap rounded-xl px-5 py-2.5 text-xs font-bold uppercase tracking-wide transition-all shadow-sm",n==="all"?"bg-[#ff3d03] text-white shadow-[#ff3d03]/20":"bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-white/10"),children:"Todos"}),$.map(t=>e.jsx("button",{onClick:()=>V(t.id),className:i("whitespace-nowrap rounded-xl px-5 py-2.5 text-xs font-bold uppercase tracking-wide transition-all shadow-sm",n===t.id?"bg-[#ff3d03] text-white shadow-[#ff3d03]/20":"bg-gray-100 dark:bg-white/5 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-white/10"),children:t.name},t.id))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Ke.map(t=>e.jsxs("div",{onClick:()=>He(t),className:"cursor-pointer group relative flex flex-col overflow-hidden rounded-2xl bg-white dark:bg-[#1a1b1e] shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 border border-gray-100 dark:border-white/5",children:[e.jsxs("div",{className:"aspect-[4/3] w-full bg-gray-100 dark:bg-white/5 relative overflow-hidden",children:[t.image_url?e.jsx("img",{src:t.image_url,alt:t.name,className:"h-full w-full object-cover group-hover:scale-105 transition-transform duration-500"}):e.jsx("div",{className:"flex h-full items-center justify-center text-gray-300 dark:text-white/10",children:e.jsx(he,{className:"h-8 w-8"})}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex justify-end",children:e.jsx("div",{className:"bg-[#ff3d03] text-white p-1.5 rounded-full shadow-lg",children:e.jsx(T,{className:"h-4 w-4"})})})]}),e.jsxs("div",{className:"p-3 flex flex-col flex-1",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 line-clamp-2 dark:text-white leading-tight mb-2 min-h-[2.5rem]",children:t.name}),e.jsxs("div",{className:"mt-auto pt-2 border-t border-gray-50 dark:border-white/5 flex items-center justify-between",children:[e.jsxs("span",{className:"text-sm font-black text-gray-900 dark:text-white",children:["R$ ",Number(t.price).toFixed(2).replace(".",",")]}),t.complement_groups&&t.complement_groups.length>0&&e.jsx("div",{className:"text-[10px] font-bold text-gray-400 bg-gray-50 dark:bg-white/5 px-2 py-0.5 rounded-md",children:"Opções"})]})]})]},t.id))})})]}),e.jsxs("div",{className:i("hidden lg:flex w-[400px] flex-col bg-white border-l border-gray-200 dark:bg-[#1a1b1e] dark:border-white/5 z-30 shadow-2xl transition-all relative",f&&"border-2 border-blue-500/50"),children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 dark:border-white/5 flex items-center justify-between bg-white dark:bg-[#1a1b1e]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-[#ff3d03]/10 flex items-center justify-center text-[#ff3d03]",children:e.jsx(S,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-base text-gray-900 dark:text-white leading-tight",children:f?`Mesa ${f.number}`:"Nova Venda"}),e.jsxs("p",{className:"text-xs text-gray-400 font-medium",children:[o.length," itens no pedido"]})]})]}),f&&e.jsx("button",{onClick:()=>{se(null),p([])},className:"text-xs text-red-500 hover:text-red-600 font-bold bg-red-50 px-3 py-1.5 rounded-lg transition-colors",children:"Sair da Mesa"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 dark:bg-[#0f1012] custom-scrollbar",children:o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4 opacity-60",children:[e.jsx(S,{className:"h-16 w-16 text-gray-300 dark:text-gray-700"}),e.jsx("p",{className:"text-sm font-medium",children:"Seu carrinho está vazio"})]}):o.map(t=>e.jsxs("div",{className:"relative group bg-white dark:bg-[#1a1b1e] p-3 rounded-2xl border border-gray-100 dark:border-white/5 hover:border-[#ff3d03]/30 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"h-14 w-14 rounded-xl bg-gray-100 dark:bg-white/5 flex-shrink-0 overflow-hidden",children:t.image_url?e.jsx("img",{src:t.image_url,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-300",children:e.jsx(he,{className:"h-6 w-6"})})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-white truncate pr-6",children:t.name}),e.jsx("button",{onClick:()=>Te(t.id),className:"absolute top-3 right-3 text-gray-400 hover:text-red-500 p-1 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(M,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex justify-between items-end mt-1",children:[e.jsxs("p",{className:"text-xs font-medium text-[#ff3d03]",children:["R$ ",Number(t.price).toFixed(2).replace(".",",")]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 dark:bg-white/5 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>J(t.id,-1),className:"h-6 w-6 flex items-center justify-center rounded-md hover:bg-white dark:hover:bg-white/10 text-gray-600 dark:text-gray-300 shadow-sm transition-all",children:e.jsx(Y,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs font-bold w-6 text-center tabular-nums dark:text-white",children:t.quantity}),e.jsx("button",{onClick:()=>J(t.id,1),className:"h-6 w-6 flex items-center justify-center rounded-md hover:bg-white dark:hover:bg-white/10 text-gray-600 dark:text-gray-300 shadow-sm transition-all",children:e.jsx(T,{className:"h-3 w-3"})})]})]})]})]}),t.notes&&e.jsxs("div",{className:"mt-2 text-[10px] text-gray-500 bg-gray-50 dark:bg-black/20 p-1.5 rounded border border-dashed border-gray-200 dark:border-white/10",children:["Note: ",t.notes]})]},t.id))}),e.jsxs("div",{className:"p-5 border-t border-gray-100 dark:border-white/5 bg-white dark:bg-[#1a1b1e] space-y-4 shadow-[0_-10px_40px_rgba(0,0,0,0.05)]",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Subtotal"}),e.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:["R$ ",C.toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-black text-gray-900 dark:text-white",children:"Total"}),e.jsxs("span",{className:"text-2xl font-black text-[#ff3d03]",children:["R$ ",C.toFixed(2).replace(".",",")]})]})]}),e.jsxs("button",{onClick:f?X:$e,disabled:o.length===0,className:"w-full h-14 flex items-center justify-center gap-2 bg-[#ff3d03] hover:bg-[#e63700] text-white font-bold text-base uppercase tracking-wide rounded-2xl shadow-lg shadow-[#ff3d03]/25 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none transition-all active:scale-[0.98]",children:[e.jsx(ue,{className:"h-5 w-5"}),f?"Enviar p/ Mesa":"Receber / Finalizar"]})]})]}),e.jsxs("button",{onClick:()=>H(!0),className:"lg:hidden fixed bottom-6 right-6 z-40 h-16 w-16 bg-[#ff3d03] hover:bg-[#e63700] text-white rounded-full shadow-2xl shadow-[#ff3d03]/40 flex items-center justify-center transition-all active:scale-95",children:[e.jsx(S,{className:"h-6 w-6"}),o.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 h-6 w-6 bg-white text-[#ff3d03] rounded-full flex items-center justify-center text-xs font-black border-2 border-[#ff3d03]",children:o.length})]}),Le&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-50 animate-fade-in",onClick:()=>H(!1)}),e.jsxs("div",{className:"lg:hidden fixed inset-y-0 right-0 w-full max-w-md bg-white dark:bg-[#1a1b1e] z-50 shadow-2xl flex flex-col animate-slide-left",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100 dark:border-white/5 flex items-center justify-between bg-white dark:bg-[#1a1b1e]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-[#ff3d03]/10 flex items-center justify-center text-[#ff3d03]",children:e.jsx(S,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-base text-gray-900 dark:text-white leading-tight",children:f?`Mesa ${f.number}`:"Nova Venda"}),e.jsxs("p",{className:"text-xs text-gray-400 font-medium",children:[o.length," itens no pedido"]})]})]}),e.jsx("button",{onClick:()=>H(!1),className:"h-10 w-10 flex items-center justify-center rounded-full hover:bg-gray-100 dark:hover:bg-white/5 text-gray-400",children:e.jsx(M,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50 dark:bg-[#0f1012]",children:o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-400 space-y-4 opacity-60",children:[e.jsx(S,{className:"h-16 w-16 text-gray-300 dark:text-gray-700"}),e.jsx("p",{className:"text-sm font-medium",children:"Seu carrinho está vazio"})]}):o.map(t=>e.jsxs("div",{className:"relative group bg-white dark:bg-[#1a1b1e] p-3 rounded-2xl border border-gray-100 dark:border-white/5 hover:border-[#ff3d03]/30 transition-colors shadow-sm",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"h-14 w-14 rounded-xl bg-gray-100 dark:bg-white/5 flex-shrink-0 overflow-hidden",children:t.image_url?e.jsx("img",{src:t.image_url,className:"h-full w-full object-cover"}):e.jsx("div",{className:"h-full w-full flex items-center justify-center text-gray-300",children:e.jsx(he,{className:"h-6 w-6"})})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 dark:text-white truncate pr-6",children:t.name}),e.jsx("button",{onClick:()=>Te(t.id),className:"absolute top-3 right-3 text-gray-400 hover:text-red-500 p-1 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(M,{className:"h-3.5 w-3.5"})})]}),e.jsxs("div",{className:"flex justify-between items-end mt-1",children:[e.jsxs("p",{className:"text-xs font-medium text-[#ff3d03]",children:["R$ ",Number(t.price).toFixed(2).replace(".",",")]}),e.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 dark:bg-white/5 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>J(t.id,-1),className:"h-6 w-6 flex items-center justify-center rounded-md hover:bg-white dark:hover:bg-white/10 text-gray-600 dark:text-gray-300 shadow-sm transition-all",children:e.jsx(Y,{className:"h-3 w-3"})}),e.jsx("span",{className:"text-xs font-bold w-6 text-center tabular-nums dark:text-white",children:t.quantity}),e.jsx("button",{onClick:()=>J(t.id,1),className:"h-6 w-6 flex items-center justify-center rounded-md hover:bg-white dark:hover:bg-white/10 text-gray-600 dark:text-gray-300 shadow-sm transition-all",children:e.jsx(T,{className:"h-3 w-3"})})]})]})]})]}),t.notes&&e.jsxs("div",{className:"mt-2 text-[10px] text-gray-500 bg-gray-50 dark:bg-black/20 p-1.5 rounded border border-dashed border-gray-200 dark:border-white/10",children:["Note: ",t.notes]})]},t.id))}),e.jsxs("div",{className:"p-5 border-t border-gray-100 dark:border-white/5 bg-white dark:bg-[#1a1b1e] space-y-4 shadow-[0_-10px_40px_rgba(0,0,0,0.05)]",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 font-medium",children:"Subtotal"}),e.jsxs("span",{className:"font-bold text-gray-900 dark:text-white",children:["R$ ",C.toFixed(2).replace(".",",")]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-black text-gray-900 dark:text-white",children:"Total"}),e.jsxs("span",{className:"text-2xl font-black text-[#ff3d03]",children:["R$ ",C.toFixed(2).replace(".",",")]})]})]}),e.jsxs("button",{onClick:()=>{H(!1),f?X():$e()},disabled:o.length===0,className:"w-full h-14 flex items-center justify-center gap-2 bg-[#ff3d03] hover:bg-[#e63700] text-white font-bold text-base uppercase tracking-wide rounded-2xl shadow-lg shadow-[#ff3d03]/25 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none transition-all active:scale-[0.98]",children:[e.jsx(ue,{className:"h-5 w-5"}),f?"Enviar p/ Mesa":"Receber / Finalizar"]})]})]})]})]}):e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 bg-gray-50 dark:bg-[#0f1012]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-white tracking-tight",children:"Mapa de Mesas"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Gerencie a ocupação e pedidos das mesas."})]}),e.jsxs("button",{onClick:()=>P(!0),className:"bg-gray-900 dark:bg-white text-white dark:text-gray-900 px-5 py-2.5 rounded-xl text-sm font-bold flex items-center gap-2 hover:opacity-90 shadow-lg",children:[e.jsx(T,{className:"h-4 w-4"})," Nova Mesa"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6",children:[b.map(t=>e.jsxs("div",{className:`relative p-8 rounded-[24px] border flex flex-col items-center justify-center min-h-[180px] transition-all duration-300 group shadow-sm hover:shadow-2xl ${t.status==="free"?"bg-light-card dark:bg-[#1a1b1e] border-gray-100 dark:border-white/5 hover:border-green-400/50":"bg-red-50 dark:bg-red-900/10 border-red-100 dark:border-red-900/20 hover:border-red-400/50"}`,children:[e.jsxs("button",{onClick:()=>{t.status==="free"?le(t):R(t)},className:`absolute top-4 right-4 flex items-center gap-1.5 text-[10px] font-black tracking-widest uppercase px-3 py-1.5 rounded-full cursor-pointer hover:scale-105 transition-all shadow-sm ${t.status==="free"?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-400":"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400"}`,children:[e.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${t.status==="free"?"bg-green-500":"bg-red-500"}`}),t.status==="free"?"LIVRE":"OCUPADA"]}),e.jsx("span",{className:"text-5xl font-black text-white dark:text-white mb-3",children:t.number}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 dark:text-gray-500 text-sm font-medium bg-gray-50 dark:bg-black/20 px-3 py-1 rounded-lg",children:[e.jsx(be,{className:"h-4 w-4"}),e.jsxs("span",{children:[t.capacity," lugares"]})]}),e.jsx("div",{className:"absolute inset-x-0 bottom-4 flex justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:()=>{confirm("Excluir mesa?")&&q.delete(route("tables.destroy",t.id))},className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors",title:"Excluir Mesa",children:e.jsx(nt,{className:"h-4 w-4"})})})]},t.id)),b.length===0&&e.jsxs("div",{className:"col-span-full py-20 flex flex-col items-center justify-center text-gray-400 dark:text-gray-600 border-2 border-dashed border-gray-200 dark:border-gray-800 rounded-3xl",children:[e.jsx(K,{className:"h-12 w-12 mb-4 opacity-20"}),e.jsx("p",{className:"font-medium",children:"Nenhuma mesa cadastrada."}),e.jsx("p",{className:"text-sm mt-1",children:"Adicione uma nova mesa para começar a gerenciar o salão."})]})]})]})]}),ee&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6 bg-black/60 backdrop-blur-sm animate-fade-in overflow-hidden",children:e.jsxs("div",{className:"bg-white dark:bg-[#1a1b1e] h-auto max-h-[92vh] sm:rounded-[2.5rem] w-full max-w-lg shadow-2xl overflow-hidden flex flex-col animate-slide-up",children:[e.jsxs("div",{className:"px-8 py-8 border-b border-gray-100 dark:border-white/5 flex justify-between items-center bg-white dark:bg-[#1a1b1e]",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black text-gray-900 dark:text-white tracking-tight",children:"Finalizar Pedido"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium",children:"Confirme os detalhes do pagamento"})]}),e.jsx("button",{onClick:()=>Q(!1),className:"h-12 w-12 bg-gray-50 dark:bg-white/5 rounded-full flex items-center justify-center text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors",children:e.jsx(M,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:X,className:"p-8 space-y-8 overflow-y-auto flex-1 custom-scrollbar max-h-[calc(100vh-180px)]",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Tipo de Pedido"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{id:"pickup",label:"Retirada",icon:S},{id:"table",label:"Mesa",icon:K},{id:"delivery",label:"Entregas",icon:be}].map(t=>e.jsx("button",{type:"button",onClick:()=>g("order_mode",t.id),className:i("py-3 px-2 rounded-xl text-sm font-bold flex flex-col items-center gap-2 transition-all border-2",r.order_mode===t.id?"border-[#ff3d03] bg-[#ff3d03]/5 text-[#ff3d03]":"border-gray-100 dark:border-white/5 bg-gray-50 dark:bg-white/5 text-gray-500 hover:border-gray-300 dark:hover:border-white/20"),children:t.label},t.id))})]}),r.order_mode==="table"&&e.jsxs("div",{className:"animate-fade-in mb-6",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Selecione a Mesa"}),e.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 gap-2 max-h-40 overflow-y-auto p-1 custom-scrollbar",children:b.map(t=>e.jsxs("button",{type:"button",onClick:()=>{oe(t.id),g("table_id",t.id)},className:i("aspect-square rounded-xl flex flex-col items-center justify-center border-2 transition-all relative overflow-hidden",x===t.id?"border-[#ff3d03] bg-[#ff3d03]/10 text-[#ff3d03] ring-2 ring-[#ff3d03]/20":t.status==="free"?"border-gray-100 dark:border-white/5 bg-white dark:bg-white/5 text-gray-600 dark:text-gray-300 hover:border-gray-300":"border-red-100 dark:border-red-900/30 bg-red-50 dark:bg-red-900/10 text-red-500 hover:border-red-300"),children:[e.jsx("span",{className:"text-lg font-black",children:t.number}),e.jsx("span",{className:"text-[10px] uppercase font-bold",children:t.status==="free"?"Livre":"Ocupada"}),x===t.id&&e.jsx("div",{className:"absolute top-1 right-1 h-2 w-2 bg-[#ff3d03] rounded-full"})]},t.id))}),x&&b.find(t=>t.id===x)?.status!=="free"&&e.jsxs("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-900/30",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx("span",{className:"text-xs font-bold text-blue-800 dark:text-blue-300",children:"Mesa Ocupada - Itens serão adicionados"})]}),b.find(t=>t.id===x)?.current_order?.items&&e.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 space-y-1 pl-6 border-l-2 border-blue-200 dark:border-blue-800/50",children:[e.jsx("p",{className:"font-bold text-gray-800 dark:text-gray-200",children:"Já na mesa:"}),b.find(t=>t.id===x)?.current_order?.items.map((t,s)=>e.jsx("div",{className:"flex justify-between",children:e.jsxs("span",{children:[t.quantity,"x ",t.product_name]})},s)),e.jsxs("div",{className:"pt-1 mt-1 border-t border-blue-200 dark:border-blue-800/30 font-bold flex justify-between",children:[e.jsx("span",{children:"Total Atual:"}),e.jsxs("span",{children:["R$ ",Number(b.find(t=>t.id===x)?.current_order?.total).toFixed(2)]})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Cliente / Fidelidade"}),e.jsx(Re,{customers:E,value:w,onChange:t=>{A(t),g(s=>({...s,customer_id:t?.id||null,customer_name:t?.name||""}))}}),w&&e.jsxs("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-xl border border-yellow-100 dark:border-yellow-900/30 flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-bold text-yellow-800 dark:text-yellow-500",children:"Saldo Fidelidade"}),e.jsxs("span",{className:"text-lg font-black text-yellow-600 dark:text-yellow-400",children:[w.loyalty_points||0," pts"]})]})]}),r.order_mode!=="table"&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Método de Pagamento"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{type:"button",onClick:()=>g("payment_method","cash"),className:i("w-full flex items-center gap-4 p-4 rounded-2xl border-2 transition-all",r.payment_method==="cash"?"border-green-500 bg-green-50/50 dark:bg-green-900/10":"border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5"),children:[e.jsx("div",{className:i("h-10 w-10 rounded-full flex items-center justify-center",r.payment_method==="cash"?"bg-green-100 text-green-600":"bg-gray-100 text-gray-400"),children:e.jsx(Oe,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("span",{className:i("block font-bold",r.payment_method==="cash"?"text-green-900 dark:text-white":"text-gray-700 dark:text-gray-300"),children:"Dinheiro"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Pagamento em espécie"})]}),r.payment_method==="cash"&&e.jsx("div",{className:"h-4 w-4 bg-green-500 rounded-full border-2 border-white ring-2 ring-green-200"})]}),e.jsxs("button",{type:"button",onClick:()=>g("payment_method","credit_card"),className:i("w-full flex items-center gap-4 p-4 rounded-2xl border-2 transition-all",r.payment_method==="credit_card"?"border-blue-500 bg-blue-50/50 dark:bg-blue-900/10":"border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5"),children:[e.jsx("div",{className:i("h-10 w-10 rounded-full flex items-center justify-center",r.payment_method==="credit_card"?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-400"),children:e.jsx(it,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("span",{className:i("block font-bold",r.payment_method==="credit_card"?"text-blue-900 dark:text-white":"text-gray-700 dark:text-gray-300"),children:"Cartão"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Crédito ou Débito"})]}),r.payment_method==="credit_card"&&e.jsx("div",{className:"h-4 w-4 bg-blue-500 rounded-full border-2 border-white ring-2 ring-blue-200"})]}),e.jsxs("button",{type:"button",onClick:()=>g("payment_method","pix"),className:i("w-full flex items-center gap-4 p-4 rounded-2xl border-2 transition-all",r.payment_method==="pix"?"border-teal-500 bg-teal-50/50 dark:bg-teal-900/10":"border-gray-100 dark:border-white/5 hover:bg-gray-50 dark:hover:bg-white/5"),children:[e.jsx("div",{className:i("h-10 w-10 rounded-full flex items-center justify-center",r.payment_method==="pix"?"bg-teal-100 text-teal-600":"bg-gray-100 text-gray-400"),children:e.jsx(ct,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("span",{className:i("block font-bold",r.payment_method==="pix"?"text-teal-900 dark:text-white":"text-gray-700 dark:text-gray-300"),children:"Pix"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Pagamento instantâneo"})]}),r.payment_method==="pix"&&e.jsx("div",{className:"h-4 w-4 bg-teal-500 rounded-full border-2 border-white ring-2 ring-teal-200"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Resumo do Pedido"}),e.jsx("div",{className:"bg-gray-50 dark:bg-black/20 rounded-2xl p-4 space-y-3 max-h-52 overflow-y-auto custom-scrollbar",children:o.map((t,s)=>e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-gray-900 dark:text-white font-bold",children:[t.quantity,"x ",t.name]}),e.jsxs("span",{className:"text-gray-900 dark:text-white font-black",children:["R$ ",((Number(t.price)+(t.selectedComplements?.reduce((l,a)=>l+a.price*a.quantity,0)||0))*t.quantity).toFixed(2).replace(".",",")]})]}),t.selectedComplements&&t.selectedComplements.length>0&&e.jsx("div",{className:"pl-4 space-y-0.5",children:t.selectedComplements.map((l,a)=>e.jsx("div",{className:"text-[10px] text-gray-500 flex justify-between",children:e.jsxs("span",{children:["+ ",l.quantity,"x ",l.name]})},a))}),t.notes&&e.jsxs("div",{className:"pl-4 text-[10px] text-[#ff3d03] italic",children:["obs: ",t.notes]})]},s))})]}),r.order_mode==="delivery"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Endereço de Entrega *"}),ne&&e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-400",children:[e.jsx(xt,{className:"w-3 h-3 animate-spin"})," Validando..."]}),!ne&&_===!0&&e.jsx("div",{className:"text-[10px] font-black text-green-500 uppercase tracking-tighter bg-green-50 dark:bg-green-900/20 px-2 py-0.5 rounded",children:"Área Coberta"}),!ne&&_===!1&&e.jsx("div",{className:"text-[10px] font-black text-red-500 uppercase tracking-tighter bg-red-50 dark:bg-red-900/20 px-2 py-0.5 rounded",children:"Fora da Área"})]}),w?.addresses&&w.addresses.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-[10px] font-bold text-gray-400 uppercase mb-2",children:"Endereços Salvos"}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 custom-scrollbar",children:w.addresses.map(t=>e.jsxs("button",{type:"button",onClick:()=>{g(s=>({...s,address_street:t.street,address_number:t.number,address_neighborhood:t.neighborhood,address_complement:t.complement||""})),Fe(t.neighborhood)},className:"flex-shrink-0 text-left p-2 rounded-lg border border-gray-100 dark:border-white/5 bg-white dark:bg-white/5 text-[10px] hover:border-[#ff3d03] transition-all",children:[e.jsxs("p",{className:"font-bold text-gray-900 dark:text-white",children:[t.street,", ",t.number]}),e.jsx("p",{className:"text-gray-500",children:t.neighborhood})]},t.id))})]}),e.jsxs("div",{className:"grid grid-cols-12 gap-2",children:[e.jsx("div",{className:"col-span-8",children:e.jsx("input",{type:"text",placeholder:"Rua / Logradouro",value:r.address_street,onChange:t=>g("address_street",t.target.value),className:"w-full text-xs p-2 rounded-lg border border-gray-200 dark:border-white/10 dark:bg-black/20"})}),e.jsx("div",{className:"col-span-4",children:e.jsx("input",{type:"text",placeholder:"Nº",value:r.address_number,onChange:t=>g("address_number",t.target.value),className:"w-full text-xs p-2 rounded-lg border border-gray-200 dark:border-white/10 dark:bg-black/20"})}),e.jsx("div",{className:"col-span-6",children:W.length>0?e.jsxs("select",{value:r.address_neighborhood,onChange:t=>{const s=t.target.value;g("address_neighborhood",s);const l=W.find(a=>a.neighborhood===s);l?(z(!0),D(Number(l.delivery_fee)),I(`Entregamos em ${l.neighborhood}`)):(z(null),D(null),I(""))},className:i("w-full text-xs p-2 rounded-lg border dark:bg-black/20 dark:text-white",_===!1?"border-red-500":"border-gray-200 dark:border-white/10"),children:[e.jsx("option",{value:"",children:"Selecione o Bairro..."}),W.map(t=>e.jsxs("option",{value:t.neighborhood,children:[t.neighborhood," (R$ ",Number(t.delivery_fee).toFixed(2).replace(".",","),")"]},t.id))]}):e.jsx("input",{type:"text",placeholder:"Bairro",value:r.address_neighborhood,onChange:t=>g("address_neighborhood",t.target.value),className:"w-full text-xs p-2 rounded-lg border border-gray-200 dark:border-white/10 dark:bg-black/20"})}),e.jsx("div",{className:"col-span-6",children:e.jsx("input",{type:"text",placeholder:"Complemento (opcional)",value:r.address_complement,onChange:t=>g("address_complement",t.target.value),className:"w-full text-xs p-2 rounded-lg border border-gray-200 dark:border-white/10 dark:bg-black/20"})})]}),_e&&e.jsxs("p",{className:i("text-[10px] font-medium px-2",_===!1?"text-red-500":"text-green-600"),children:[_e," ",F!==null&&`- Taxa: R$ ${F.toFixed(2)}`]})]}),e.jsxs("div",{className:"flex justify-between items-end pt-4 border-t border-gray-100 dark:border-white/5",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Total a pagar"}),e.jsxs("span",{className:"text-3xl font-black text-gray-900 dark:text-white",children:["R$ ",C.toFixed(2).replace(".",",")]})]}),Object.keys(Ne).length>0&&e.jsxs("div",{className:"mx-6 px-4 py-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-400 font-bold text-sm mb-1",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{children:"Erro ao processar pedido"})]}),e.jsx("ul",{className:"list-disc list-inside text-xs text-red-600 dark:text-red-300",children:Object.entries(Ne).map(([t,s])=>e.jsx("li",{children:s},t))})]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 dark:border-white/5 bg-gray-50 dark:bg-black/20 space-y-3",children:[r.order_mode==="delivery"&&!r.customer_name&&e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl",children:[e.jsx(ge,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-xs font-medium text-yellow-800 dark:text-yellow-500",children:"Preencha o endereço de entrega"})]}),e.jsx("button",{onClick:t=>X(t),disabled:de||r.order_mode==="delivery"&&!r.customer_name||r.order_mode==="delivery"&&_===!1||r.order_mode==="table"&&!x,className:i("w-full rounded-2xl py-4 text-base font-bold uppercase tracking-wide text-white shadow-xl transition-all",de||r.order_mode==="delivery"&&!r.customer_name||r.order_mode==="delivery"&&_===!1||r.order_mode==="table"&&!x?"bg-gray-400 cursor-not-allowed shadow-none":"bg-[#ff3d03] shadow-[#ff3d03]/20 hover:bg-[#e63700] hover:scale-[1.02] active:scale-100"),children:de?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processando..."]}):r.order_mode==="table"?x?b.find(t=>t.id===x)?.status!=="free"?`Adicionar à Mesa ${b.find(t=>t.id===x)?.number||""}`:`Abrir Mesa ${b.find(t=>t.id===x)?.number||""}`:"Selecione uma Mesa":`✓ Confirmar ${r.order_mode==="delivery"?"Entrega":r.order_mode==="pickup"?"Retirada":"Mesa"} - R$ ${C.toFixed(2)}`})]})]})]})}),e.jsx(xe,{show:De,onClose:()=>P(!1),maxWidth:"sm",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-black text-gray-900 dark:text-white tracking-tight",children:"Nova Mesa"}),e.jsx("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(M,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:Ue,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(me,{value:"Número da Mesa",className:"mb-2"}),e.jsx(Pe,{type:"number",className:"w-full text-lg font-bold text-center h-14 rounded-xl",value:je.number,onChange:t=>we("number",t.target.value),placeholder:"Ex: 10",required:!0})]}),e.jsxs("div",{children:[e.jsx(me,{value:"Capacidade",className:"mb-2"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 bg-gray-100 rounded-full flex items-center justify-center text-gray-500",children:e.jsx(be,{className:"h-6 w-6"})}),e.jsx(Pe,{type:"number",className:"flex-1 text-lg font-bold h-12 rounded-xl",value:je.capacity,onChange:t=>we("capacity",t.target.value),min:"1",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-4 border-t border-gray-100 dark:border-white/5",children:[e.jsx("button",{type:"button",onClick:()=>P(!1),className:"px-5 py-2.5 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancelar"}),e.jsx(ot,{disabled:Qe,className:"bg-[#ff3d03] border-transparent rounded-xl px-6 py-3 shadow-lg hover:bg-[#e63700]",children:"Salvar Mesa"})]})]})]})}),e.jsx(xe,{show:!!G,onClose:()=>le(null),maxWidth:"sm",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"h-16 w-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(K,{className:"h-8 w-8"})}),e.jsxs("h2",{className:"text-2xl font-black text-gray-900 dark:text-white",children:["Abrir Mesa ",G?.number]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Inicie um novo atendimento para esta mesa."})]}),e.jsxs("form",{onSubmit:et,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(me,{value:"Nome do Cliente (Opcional)",className:"mb-2"}),e.jsx(Re,{customers:E,value:w,onChange:A})]}),e.jsx("button",{className:"w-full rounded-2xl bg-green-600 py-4 text-white font-bold text-base uppercase tracking-wide shadow-lg hover:bg-green-700 transition-all",children:"Iniciar Atendimento"})]})]})}),e.jsx(xe,{show:!!j,onClose:()=>R(null),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["Mesa ",j?.number]}),e.jsx("button",{onClick:()=>R(null),children:e.jsx(M,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-lg mb-4 max-h-60 overflow-y-auto",children:[e.jsx("h3",{className:"font-bold text-sm mb-2 text-gray-500",children:"CONSUMO ATUAL"}),j?.current_order?.items?.map((t,s)=>e.jsxs("div",{className:"flex justify-between py-1 border-b border-gray-100 last:border-0 dark:border-gray-700 text-sm",children:[e.jsxs("span",{children:[t.quantity,"x ",t.product_name]}),e.jsxs("span",{children:["R$ ",Number(t.subtotal).toFixed(2)]})]},s)),e.jsxs("div",{className:"flex justify-between font-bold mt-2 pt-2 border-t border-gray-200",children:[e.jsx("span",{children:"Total Parcial"}),e.jsxs("span",{children:["R$ ",Number(j?.current_order?.total||0).toFixed(2)]})]}),j?.current_order?.customer&&e.jsxs("div",{className:"mt-2 text-xs text-green-600 font-medium flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3 w-3"})," ",j.current_order.customer.name]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>{se(j),R(null),B("sales"),p([])},className:"flex items-center justify-center gap-2 bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700",children:[e.jsx(T,{className:"h-4 w-4"})," Adicionar Itens"]}),e.jsxs("button",{onClick:Ye,className:"flex items-center justify-center gap-2 bg-green-600 text-white font-bold py-3 rounded-lg hover:bg-green-700",children:[e.jsx(Oe,{className:"h-4 w-4"})," Fechar Conta"]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-xs uppercase font-bold text-gray-500",children:"Forma de Pagamento (Fechar)"}),e.jsxs("select",{value:ye,onChange:t=>Ie(t.target.value),className:"w-full mt-1 rounded-md border-gray-300 dark:bg-gray-700 dark:border-gray-600",children:[e.jsx("option",{value:"cash",children:"Dinheiro"}),e.jsx("option",{value:"credit_card",children:"Cartão de Crédito"}),e.jsx("option",{value:"debit_card",children:"Cartão de Débito"}),e.jsx("option",{value:"pix",children:"Pix"})]})]})]})}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-[#1a1b1e] rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[e.jsxs("div",{className:"sticky top-0 bg-white dark:bg-[#1a1b1e] px-6 py-4 border-b border-gray-200 dark:border-gray-800 flex justify-between items-center z-10",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:m.name}),e.jsx("button",{onClick:Ce,className:"text-gray-400 hover:text-gray-600",children:e.jsx(M,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:["R$ ",Number(m.price).toFixed(2).replace(".",",")]}),m.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:m.description})]}),m.complement_groups&&m.complement_groups.length>0&&e.jsx("div",{className:"space-y-4",children:m.complement_groups.map(t=>{const s=Me(t.id),l=!t.is_required||s>=t.min_selections;return e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white",children:[t.name,t.is_required&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:`text-xs font-medium px-2 py-1 rounded ${l?"bg-green-50 text-green-700":"bg-orange-50 text-orange-700"}`,children:[s,"/",t.max_selections]}),t.min_selections>0&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Mín: ",t.min_selections]})]})]}),e.jsx("div",{className:"space-y-2",children:t.options.map(a=>{const c=Z[t.id]?.[a.id]||0,h=a.max_quantity||999,u=c<h&&s<t.max_selections;return e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-xl transition-colors ${c>0?"bg-orange-50 border-[#ff3d03]":"bg-white hover:bg-gray-50"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-700",children:a.name}),h<999&&e.jsxs("span",{className:"text-xs text-gray-400",children:["(máx: ",h,")"]})]}),a.price>0&&e.jsxs("span",{className:"text-sm text-gray-600",children:["+R$ ",a.price.toFixed(2).replace(".",","),c>1&&` × ${c} = R$ ${(a.price*c).toFixed(2).replace(".",",")}`]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Se(t.id,a.id,-1,h,t.max_selections),disabled:c===0,className:"h-8 w-8 rounded-lg bg-gray-200 text-gray-700 flex items-center justify-center disabled:opacity-30 disabled:cursor-not-allowed hover:bg-gray-300 transition-colors",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center font-bold text-gray-900",children:c}),e.jsx("button",{onClick:()=>Se(t.id,a.id,1,h,t.max_selections),disabled:!u,className:"h-8 w-8 rounded-lg bg-[#ff3d03] text-white flex items-center justify-center disabled:opacity-30 disabled:cursor-not-allowed hover:bg-[#e63700] transition-colors",children:e.jsx(T,{className:"h-4 w-4"})})]})]},a.id)})})]},t.id)})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Observações (opcional)"}),e.jsx("textarea",{value:fe,onChange:t=>re(t.target.value),placeholder:"Ex: Sem cebola, bem passado...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#ff3d03] focus:border-transparent dark:bg-gray-800 dark:border-gray-700 dark:text-white resize-none",rows:2})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>U(Math.max(1,O-1)),className:"h-10 w-10 rounded-lg bg-gray-200 text-gray-700 flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx(Y,{className:"h-5 w-5"})}),e.jsx("span",{className:"text-xl font-bold text-gray-900 dark:text-white w-12 text-center",children:O}),e.jsx("button",{onClick:()=>U(O+1),className:"h-10 w-10 rounded-lg bg-[#ff3d03] text-white flex items-center justify-center hover:bg-[#e63700] transition-colors",children:e.jsx(T,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Total"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",Xe().toFixed(2).replace(".",",")]})]})]}),e.jsxs("button",{onClick:()=>{const t=Je();if(!t.valid){alert(t.message);return}We()},className:"w-full flex items-center justify-center gap-2 bg-green-600 hover:bg-green-700 text-white font-bold py-4 rounded-xl shadow-lg transition-all active:scale-[0.98]",children:[e.jsx(S,{className:"h-5 w-5"}),"Adicionar ao Carrinho"]})]})]})})]})}export{vs as default};
