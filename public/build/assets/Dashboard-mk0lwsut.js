import{r as m,j as e,d as k,L as j,H as T,a as _}from"./app-DbPWLEQz.js";import{M as C}from"./MotoboyLayout-Bi1OVYBv.js";import{P as L}from"./power-Df4keFm7.js";import{U as S}from"./user-CKed5UKK.js";import{P as E}from"./phone-BiEJVTcE.js";import{M as y}from"./map-pin-DSyt0YTv.js";import{C as P}from"./clock-S-42N5z_.js";import{D as M}from"./dollar-sign-axyloPHj.js";import{L as $}from"./LocationTracker-DLLqfuE1.js";import{M as D}from"./MapComponent-LnNyA5-3.js";import{M as A}from"./map-C9hUY1a1.js";import{P as F}from"./package-BoeND7Xk.js";import{T as I}from"./trending-up-CF5UYBuK.js";import"./layout-dashboard-9BlQdCEh.js";import"./bell-BDtw9j92.js";import"./chevron-right-CBRKy-mZ.js";import"./chevron-left-DusbTLOp.js";import"./log-out-DKUiWj6w.js";import"./menu-CipS6wKn.js";import"./use-resolve-button-type-CEmk7fhE.js";import"./keyboard-DuHvJwgB.js";import"./use-sync-refs-DmsoagOF.js";import"./portal-D4W2IGS0.js";import"./with-selector-o_2PE-6E.js";import"./transition-DsAP_ylf.js";import"./circle-alert-dYVgQw7D.js";import"./navigation-hPOwl1_g.js";import"./usePushNotifications-Bw5K8vt_.js";import"./menu-DyhUAhI6.js";function R({isOnline:s,status:i,onToggle:n,disabled:l=!1}){const[c,h]=m.useState(!1),p=async()=>{h(!0);try{const r=await k.post(route("motoboy.availability.toggle"));r.data.success&&n(r.data.is_online)}catch(r){console.error("Erro ao atualizar status:",r)}finally{h(!1)}},a=s?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700",d=s?"ONLINE":"OFFLINE",g=s?"bg-green-500":"bg-gray-400";return e.jsxs("div",{className:`flex items-center gap-4 px-6 py-4 rounded-2xl border-2 transition-all ${s?"border-green-200 bg-green-50":"border-gray-200 bg-white"}`,children:[e.jsx("button",{onClick:p,disabled:l||c,className:`
                    flex items-center justify-center w-14 h-14 rounded-full
                    transition-all transform
                    ${s?"bg-green-500 hover:bg-green-600 shadow-lg shadow-green-500/30":"bg-gray-400 hover:bg-gray-500 shadow-lg shadow-gray-500/30"}
                    ${l||c?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                    active:scale-95
                `,title:s?"Ir Offline":"Ir Online",children:e.jsx(L,{className:`w-6 h-6 text-white ${c?"animate-spin":""}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-gray-600 uppercase tracking-widest",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full animate-pulse ${g}`}),e.jsx("p",{className:`text-lg font-black ${a} px-3 py-1 rounded-full`,children:d})]})]}),c&&e.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Atualizando..."})]})}function z({orderId:s,orderNumber:i,customerName:n,customerPhone:l,deliveryAddress:c,total:h,deliveryFee:p,itemsCount:a,estimatedTimeMinutes:d,createdAt:g,showActions:r=!0,onAccept:f,loading:x=!1}){const o=u=>{u.preventDefault(),f?.(s)};return e.jsx(j,{href:route("motoboy.orders.show",s),children:e.jsxs("div",{className:"bg-white rounded-2xl border-2 border-gray-200 p-6 hover:border-[#ff3d03] hover:shadow-md transition-all cursor-pointer h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-600 uppercase tracking-widest",children:"Pedido"}),e.jsxs("p",{className:"text-lg font-black text-gray-900",children:["#",i]})]}),g&&e.jsx("span",{className:"text-xs font-bold text-gray-500 bg-gray-100 px-3 py-1 rounded-full",children:g})]}),e.jsx("div",{className:"mb-4 pb-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(S,{className:"w-5 h-5 text-[#ff3d03]"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:n}),e.jsxs("a",{href:`tel:${l}`,onClick:u=>u.preventDefault(),className:"text-xs text-[#ff3d03] font-medium flex items-center gap-1 hover:underline",children:[e.jsx(E,{className:"w-3 h-3"}),l]})]})]})}),e.jsxs("div",{className:"mb-4 flex gap-3",children:[e.jsx(y,{className:"w-5 h-5 text-[#ff3d03] flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs font-bold text-gray-600 uppercase tracking-widest",children:"Entrega"}),e.jsx("p",{className:"text-sm font-medium text-gray-700 line-clamp-2",children:c})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-blue-600 font-bold",children:"Itens"}),e.jsx("p",{className:"text-lg font-black text-blue-700",children:a})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-green-600 font-bold",children:"Tempo"}),e.jsxs("p",{className:"text-lg font-black text-green-700 flex items-center justify-center gap-1",children:[e.jsx(P,{className:"w-4 h-4"}),d,"m"]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 text-center",children:[e.jsx("p",{className:"text-xs text-purple-600 font-bold",children:"Taxa"}),e.jsxs("p",{className:"text-lg font-black text-purple-700 flex items-center justify-center gap-1",children:[e.jsx(M,{className:"w-4 h-4"}),"R$",p]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Total do Pedido"}),e.jsxs("p",{className:"text-xl font-black text-gray-900",children:["R$ ",h.toFixed(2)]})]}),r&&e.jsx("button",{onClick:o,disabled:x,className:`
                                px-4 py-2 rounded-lg font-bold text-sm uppercase tracking-widest
                                transition-all
                                ${x?"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-[#ff3d03] text-white hover:bg-[#e63700] active:scale-95"}
                            `,children:x?"...":"Aceitar"})]})]})})}function fe({user:s,summary:i,availableOrders:n,pendingOrders:l,recentDeliveries:c,notificationCount:h,googleMapsApiKey:p}){const[a,d]=m.useState(i.is_online),[g,r]=m.useState(null),[f,x]=m.useState(null),[o,u]=m.useState(null),N=m.useCallback(async t=>{d(t),x(null);try{const b=await fetch(route("motoboy.availability.toggle"),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.content??"",Accept:"application/json"}});if(!b.ok)throw new Error("Falha ao atualizar status");const w=await b.json();d(w.is_online)}catch{d(!t),x("Não foi possível atualizar o status. Tente novamente.")}},[]),v=async t=>{r(t),_.post(route("motoboy.orders.accept",t),{},{preserveScroll:!0,onSuccess:()=>{r(null)},onError:()=>{r(null)}})};Array(Math.round(i.average_rating)).fill(null).map(()=>"★").join("");const[O,U]=m.useState(!1);return e.jsxs(C,{title:"Dashboard",subtitle:`Olá, ${s.name}`,isOnline:a,children:[e.jsx(T,{title:"Dashboard - ÓoDelivery Motoboy"}),f&&e.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-700 text-sm font-semibold rounded-xl px-4 py-3 flex items-center justify-between",children:[e.jsx("span",{children:f}),e.jsx("button",{onClick:()=>x(null),className:"ml-3 text-red-400 hover:text-red-600",children:"✕"})]}),e.jsx($,{enabled:a,orderId:l[0]?.id,interval:15,onLocationUpdate:u}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("section",{className:"lg:col-span-1",children:[e.jsx(R,{isOnline:a,status:i.status,onToggle:N}),a&&o&&e.jsxs("div",{className:"mt-4 bg-white rounded-2xl border border-gray-100 p-4 shadow-sm",children:[e.jsxs("h4",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 mb-3 flex items-center gap-2",children:[e.jsx(y,{className:"w-3 h-3 text-blue-500"})," Sua Posição"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold",children:"LAT/LNG"}),e.jsxs("span",{className:"text-xs font-mono font-bold text-gray-900",children:[o.latitude.toFixed(5),", ",o.longitude.toFixed(5)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-50",children:[e.jsx("span",{className:"text-xs text-gray-500 font-bold",children:"PRECISÃO"}),e.jsxs("span",{className:"text-xs font-bold text-gray-900",children:["±",Math.round(o.accuracy),"m"]})]})]})]})]}),e.jsx("section",{className:"lg:col-span-2",children:e.jsx("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden shadow-sm h-[300px] relative",children:a&&p?e.jsx(D,{currentLocation:o?{lat:o.latitude,lng:o.longitude}:void 0,apiKey:p,height:"300px",zoom:15}):e.jsxs("div",{className:"absolute inset-0 bg-gray-50 flex flex-col items-center justify-center text-center p-6",children:[e.jsx(A,{className:"w-12 h-12 text-gray-200 mb-3"}),e.jsx("p",{className:"text-sm font-bold text-gray-400",children:a?"Mapa indisponível":"Fique Online para ativar o mapa"})]})})})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-gray-900 flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500 animate-pulse"}),"Pedidos Chegando"]}),n.length>0&&e.jsx("span",{className:"text-xs font-bold bg-[#ff3d03] text-white px-3 py-1 rounded-full",children:n.length})]}),n.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4",children:n.map(t=>e.jsx(z,{orderId:t.id,orderNumber:t.order_number,customerName:t.customer_name,customerPhone:t.customer_phone,deliveryAddress:t.delivery_address,total:t.total,deliveryFee:t.delivery_fee,itemsCount:t.items_count,estimatedTimeMinutes:t.estimated_time_minutes,createdAt:t.created_at,showActions:!0,onAccept:v,loading:g===t.id},t.id))}):e.jsxs("div",{className:"bg-white rounded-2xl border-2 border-dashed border-gray-200 p-8 text-center opacity-70",children:[e.jsx(F,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm font-bold text-gray-400",children:"Aguardando novos pedidos..."})]})]}),l.length>0&&e.jsxs("section",{children:[e.jsx("h2",{className:"text-xs font-black uppercase tracking-widest text-gray-600 mb-4",children:"Em Entrega"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:l.map(t=>e.jsx("div",{className:"bg-white border-l-4 border-yellow-400 rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-xs font-bold bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded",children:["#",t.order_number]}),e.jsx("h3",{className:"font-bold text-gray-900 mt-1",children:t.customer_name}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-1",children:t.delivery_address})]}),e.jsx(j,{href:route("motoboy.orders.show",t.id),className:"text-[#ff3d03] font-bold text-sm bg-orange-50 px-3 py-2 rounded-lg",children:"Detalhes"})]})},t.id))})]}),e.jsx("section",{className:"pt-4 border-t border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase",children:"Ganhos Hoje"}),e.jsxs("p",{className:"text-2xl font-black text-gray-900",children:["R$ ",i.earnings_today.toFixed(2)]})]}),e.jsxs(j,{href:route("motoboy.metrics"),className:"text-xs font-bold text-gray-500 hover:text-[#ff3d03] flex items-center gap-1",children:["Ver tudo ",e.jsx(I,{className:"w-3 h-3"})]})]})})]})]})}export{fe as default};
