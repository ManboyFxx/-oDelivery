import{d as l,j as e,L as C,_ as S,b1 as I,b2 as k,b3 as M,H as P,ax as z,b4 as G,b5 as _,b0 as $,C as q,t as H}from"./vendor-react-BYm2vN5O.js";import{A as U}from"./AuthenticatedLayout-CC45zQvs.js";import{A as B}from"./ApplicationLogo-BjA2P5YC.js";import{b$ as X,c0 as J,b0 as p,c1 as Q,c2 as W,c3 as Y,c4 as Z,c5 as ee,c6 as te}from"./vendor-others-BqROYnIz.js";import T from"./DraggableKitchenCard-Be98yXod.js";import"./vendor-utils-DuuP9eDp.js";import"./Modal-BU8I6Kmo.js";import"./app-Dqn1zKfB.js";import"./vendor-animation-DqfYcVFE.js";function se({children:r,isFullscreen:o,toggleFullscreen:b}){const[t,c]=l.useState(new Date);return l.useEffect(()=>{const d=setInterval(()=>c(new Date),1e3);return()=>clearInterval(d)},[]),e.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col",children:[e.jsxs("header",{className:"flex items-center justify-between px-6 py-3 bg-gray-800 border-b border-gray-700 shadow-lg shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{href:"/",className:"shrink-0",children:e.jsx(B,{className:"block h-8 w-auto fill-current text-white"})}),e.jsx("div",{className:"h-6 w-px bg-gray-600 mx-2"}),e.jsx("h1",{className:"text-xl font-bold tracking-tight text-white/90",children:"KDS - Kitchen Display System"})]}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-300 font-mono text-lg bg-gray-900/50 px-4 py-1.5 rounded-lg border border-gray-700",children:[e.jsx(S,{className:"h-4 w-4 text-[#ff3d03]"}),e.jsx("span",{children:t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:b,className:"p-2 rounded-lg bg-gray-700 hover:bg-gray-600 text-gray-200 transition-colors",title:o?"Sair da Tela Cheia":"Tela Cheia",children:o?e.jsx(I,{className:"h-5 w-5"}):e.jsx(k,{className:"h-5 w-5"})}),e.jsxs(C,{href:"/dashboard",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-[#ff3d03] hover:bg-[#e63700] rounded-lg transition-colors",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sair"})]})]})]})]}),e.jsx("main",{className:"flex-1 overflow-hidden relative",children:e.jsx("div",{className:"absolute inset-0 p-4 overflow-auto scrollbar-hide",children:r})})]})}function re(r=!0){const o=l.useRef(null);return l.useEffect(()=>{if(r){const t=new(window.AudioContext||window.webkitAudioContext);t.createOscillator(),t.createGain(),o.current=new Audio}return()=>{o.current&&(o.current.pause(),o.current=null)}},[r]),{play:()=>{if(!r||!o.current)return;const t=new(window.AudioContext||window.webkitAudioContext),c=t.createOscillator(),d=t.createGain();c.connect(d),d.connect(t.destination),c.frequency.value=800,c.type="sine",d.gain.setValueAtTime(0,t.currentTime),d.gain.linearRampToValueAtTime(.3,t.currentTime+.01),d.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),c.start(t.currentTime),c.stop(t.currentTime+.5),setTimeout(()=>{const m=t.createOscillator(),a=t.createGain();m.connect(a),a.connect(t.destination),m.frequency.value=1e3,m.type="sine",a.gain.setValueAtTime(0,t.currentTime),a.gain.linearRampToValueAtTime(.3,t.currentTime+.01),a.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),m.start(t.currentTime),m.stop(t.currentTime+.5)},200)}}}function xe({orders:r}){const[o,b]=l.useState({}),[t,c]=l.useState(null),[d,m]=l.useState(r.filter(s=>s.status==="new").length),[a,E]=l.useState(!0),[j,w]=l.useState(!1),{play:A}=re(a),y=()=>{document.fullscreenElement?document.exitFullscreen().then(()=>{w(!1)}):document.documentElement.requestFullscreen().then(()=>{w(!0)}).catch(s=>{console.error(`Error attempting to enable fullscreen: ${s.message}`)})};l.useEffect(()=>{const s=()=>{w(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",s),()=>document.removeEventListener("fullscreenchange",s)},[]),l.useEffect(()=>{const s=r.filter(n=>n.status==="new").length;s>d&&a&&A(),m(s)},[r,a]),l.useEffect(()=>{const s=setInterval(()=>{const n={};r.forEach(i=>{const u=new Date(i.created_at).getTime(),x=new Date().getTime()-u,f=Math.floor(x/(1e3*60)),h=Math.floor(x%(1e3*60)/1e3);n[i.id]=`${f}:${h.toString().padStart(2,"0")}`}),b(n)},1e3);return()=>clearInterval(s)},[r]);const D=(s,n)=>{H.post(route("kitchen.update-status",s),{status:n},{preserveScroll:!0,preserveState:!0})},O=r.filter(s=>s.status==="new"),V=r.filter(s=>s.status==="preparing"),L=r.filter(s=>s.status==="ready"),R=X(J(Z,{activationConstraint:{distance:8}})),K=s=>{const{active:n}=s,i=r.find(u=>u.id===n.id);c(i||null)},F=s=>{const{active:n,over:i}=s;if(c(null),!i)return;const u=n.id,g=i.id,x=r.find(f=>f.id===u);!x||x.status===g||D(u,g)},v=({id:s,title:n,orders:i,icon:u,color:g,bgClass:x,borderClass:f})=>e.jsxs("div",{className:p("flex flex-col rounded-2xl overflow-hidden border transition-all duration-300",x,f,j?"h-full":"h-[calc(100vh-200px)] min-h-[600px]"),children:[e.jsxs("div",{className:p("p-4 border-b flex justify-between items-center",f,g),children:[e.jsxs("div",{className:"flex items-center gap-2 font-bold uppercase tracking-wider",children:[e.jsx(u,{className:"h-5 w-5"}),n]}),e.jsx("div",{className:p("px-2 py-1 rounded-lg text-xs font-bold bg-white/20"),children:i.length})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-3 scrollbar-hide",children:[e.jsx(ee,{id:s,items:i.map(h=>h.id),strategy:te,children:e.jsx("div",{className:"space-y-3 min-h-[100px]",children:i.map(h=>e.jsx(T,{order:h,elapsedTime:o[h.id]},h.id))})}),i.length===0&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 opacity-50",children:[e.jsx(u,{className:"h-12 w-12 mb-2"}),e.jsx("p",{className:"font-medium text-sm",children:"Vazio"})]})]})]}),N=e.jsxs("div",{className:p("flex flex-col h-full",j?"p-4":""),children:[e.jsx(P,{title:"Cozinha (KDS)"}),!j&&e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-black dark:text-white flex items-center gap-3",children:[e.jsx(z,{className:"h-8 w-8 text-[#ff3d03]"}),"Kitchen Display System"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Gerencie a produção em tempo real"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>E(!a),className:p("p-3 rounded-xl border transition-colors",a?"bg-white dark:bg-[#1a1b1e] border-gray-200 dark:border-white/10 text-[#ff3d03] shadow-sm":"bg-gray-100 dark:bg-white/5 border-transparent text-gray-400"),title:a?"Som Ativado":"Som Mudo",children:a?e.jsx(G,{className:"h-5 w-5"}):e.jsx(_,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-gray-900 dark:bg-white text-white dark:text-gray-900 rounded-xl font-bold shadow-lg hover:scale-105 transition-transform",children:[e.jsx(k,{className:"h-4 w-4"}),"Modo Tela Cheia"]})]})]}),e.jsxs(Q,{sensors:R,collisionDetection:W,onDragStart:K,onDragEnd:F,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 h-full",children:[e.jsx("div",{id:"new",className:"h-full",children:e.jsx(v,{id:"new",title:"Novos Pedidos",orders:O,icon:S,color:"text-blue-500",bgClass:"bg-blue-50/50 dark:bg-blue-900/10",borderClass:"border-blue-100 dark:border-blue-500/20"})}),e.jsx("div",{id:"preparing",className:"h-full",children:e.jsx(v,{id:"preparing",title:"Em Preparo",orders:V,icon:$,color:"text-[#ff3d03]",bgClass:"bg-orange-50/50 dark:bg-orange-900/10",borderClass:"border-orange-100 dark:border-[#ff3d03]/20"})}),e.jsx("div",{id:"ready",className:"h-full",children:e.jsx(v,{id:"ready",title:"Prontos",orders:L,icon:q,color:"text-green-500",bgClass:"bg-green-50/50 dark:bg-green-900/10",borderClass:"border-green-100 dark:border-green-500/20"})})]}),e.jsx(Y,{children:t?e.jsx("div",{className:"w-[350px] rotate-3 cursor-grabbing opacity-90",children:e.jsx(T,{order:t,elapsedTime:o[t.id],isOverlay:!0})}):null})]})]});return j?e.jsx(se,{isFullscreen:!0,toggleFullscreen:y,children:N}):e.jsx(U,{children:N})}export{xe as default};
