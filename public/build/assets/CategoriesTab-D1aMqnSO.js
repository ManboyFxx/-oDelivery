import{r as o,u as F,j as e,X as U,a as p}from"./app-TTZ6yfYt.js";import{M as W}from"./Modal-48PZuyWw.js";import{I as f}from"./InputLabel-CjJFwicP.js";import{T as N}from"./TextInput-KWfHzR6p.js";import{P as X}from"./PrimaryButton-3ujQzmlE.js";import{S as H}from"./SecondaryButton-C7WXyfu5.js";import{I as h}from"./InputError-DGb6P6MF.js";import{M as J}from"./MediaPickerModal-DpVgX8wq.js";import{k as Q,l as C,D as V,n as Y,o as Z,P as $}from"./core.esm-aC784N_d.js";import{S as ee,v as te,s as ae,a as re}from"./sortable.esm-8rJjMH0x.js";import se from"./DraggableCategoryItem-jfXFbb_C.js";import{S}from"./search-Qdzzigq9.js";import{P as oe}from"./plus-D0H8QIYy.js";import{I as ie}from"./image-DglWeLfK.js";import"./keyboard-BQvCND68.js";import"./use-sync-refs-6-NS1CTg.js";import"./portal-5ufihSUC.js";import"./with-selector-DUY2HtF-.js";import"./hidden-CExFSfQ-.js";import"./transition-Bs7QEe6q.js";import"./loader-circle-ZypQRF6q.js";import"./check-C5AhucfN.js";import"./trash-2-DNWCUWnN.js";import"./upload-DbgEYyjw.js";import"./grip-vertical-DaX7X2Zz.js";import"./pencil-DYU8Y-QQ.js";function Te({categories:k}){const[n,c]=o.useState(k),[b,I]=o.useState(""),[D,r]=o.useState(!1),[i,j]=o.useState(null),[P,m]=o.useState(!1),[M,v]=o.useState(null),E=Q(C($),C(Z,{coordinateGetter:ae})),{data:s,setData:l,post:_,put:le,processing:B,reset:O,errors:x,delete:de}=F({name:"",description:"",image_url:""}),u=n.filter(t=>t.name.toLowerCase().includes(b.toLowerCase()));function T(t){const{active:a,over:y}=t;v(null),a.id!==y?.id&&c(g=>{const K=g.findIndex(d=>d.id===a.id),R=g.findIndex(d=>d.id===y?.id),w=re(g,K,R);return p.post(route("categories.reorder"),{categories:w.map((d,z)=>({id:d.id,sort_order:z}))},{preserveScroll:!0}),w})}const L=()=>{j(null),O(),r(!0)},q=t=>{j(t),l({name:t.name,description:t.description||"",image_url:t.image_url||""}),r(!0)},A=t=>{t.preventDefault(),i?p.put(route("categories.update",i.id),s,{onSuccess:()=>{r(!1),c(n.map(a=>a.id===i.id?{...a,...s}:a))}}):_(route("categories.store"),{onSuccess:()=>{r(!1),window.location.reload()}})},G=t=>{confirm("Tem certeza que deseja excluir esta categoria? Produtos vinculados podem ficar sem categoria.")&&p.delete(route("categories.destroy",t),{preserveScroll:!0,onSuccess:()=>{c(n.filter(a=>a.id!==t))}})};return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white hidden md:block",children:"Gerenciar Categorias"}),e.jsxs("div",{className:"flex gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-72",children:[e.jsx(S,{className:"absolute left-4 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:b,onChange:t=>I(t.target.value),placeholder:"Buscar categorias...",className:"w-full h-11 rounded-2xl border border-gray-200 bg-white pl-11 shadow-sm focus:border-[#ff3d03] focus:ring-[#ff3d03]/20 dark:border-white/5 dark:bg-[#0f1012] transition-all"})]}),e.jsxs("button",{onClick:L,className:"flex items-center gap-2 rounded-2xl bg-[#ff3d03] px-6 py-3 text-sm font-bold text-white shadow-lg shadow-[#ff3d03]/20 hover:bg-[#e63700] hover:scale-105 active:scale-95 transition-all whitespace-nowrap",children:[e.jsx(oe,{className:"h-5 w-5"}),"Nova Categoria"]})]})]}),e.jsx("div",{className:"bg-white dark:bg-[#1a1b1e] rounded-[24px] shadow-sm border border-gray-100 dark:border-white/5 overflow-hidden",children:e.jsx(V,{sensors:E,collisionDetection:Y,onDragStart:({active:t})=>v(t.id),onDragEnd:T,children:e.jsx(ee,{items:u.map(t=>t.id),strategy:te,children:e.jsxs("ul",{className:"divide-y divide-gray-100 dark:divide-white/5",children:[u.map(t=>e.jsx(se,{category:t,onEdit:q,onDelete:G,isDragging:M===t.id},t.id)),u.length===0&&e.jsxs("li",{className:"p-12 text-center flex flex-col items-center justify-center text-gray-500",children:[e.jsx("div",{className:"h-16 w-16 bg-gray-50 dark:bg-white/5 rounded-full flex items-center justify-center mb-4",children:e.jsx(S,{className:"h-8 w-8 text-gray-300"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Nenhuma categoria encontrada"})]})]})})})}),e.jsx(W,{show:D,onClose:()=>r(!1),maxWidth:"md",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-black text-gray-900 dark:text-white",children:i?"Editar Categoria":"Nova Categoria"}),e.jsx("button",{type:"button",onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx(U,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(f,{value:"Nome *"}),e.jsx(N,{className:"w-full mt-1",value:s.name,onChange:t=>l("name",t.target.value),required:!0,placeholder:"Ex: Bebidas"}),e.jsx(h,{message:x.name,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(f,{value:"Descrição"}),e.jsx(N,{className:"w-full mt-1",value:s.description,onChange:t=>l("description",t.target.value),placeholder:"Breve descrição da categoria"}),e.jsx(h,{message:x.description,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(f,{value:"Imagem da Categoria"}),e.jsx("div",{onClick:()=>m(!0),className:"mt-1 flex flex-col items-center justify-center border-2 border-dashed border-gray-300 rounded-2xl hover:border-[#ff3d03] transition-colors cursor-pointer relative bg-gray-50 dark:bg-gray-800 h-32 overflow-hidden",children:s.image_url?e.jsxs("div",{className:"relative w-full h-full group",children:[e.jsx("img",{src:s.image_url,alt:"Preview",className:"w-full h-full object-cover"}),e.jsxs("div",{className:"absolute inset-0 bg-black/40 flex flex-col items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity gap-2",children:[e.jsx("p",{className:"text-white text-xs font-bold",children:"Trocar Imagem"}),e.jsx("button",{type:"button",onClick:t=>{t.stopPropagation(),l("image_url","")},className:"text-[10px] text-red-300 hover:text-red-100",children:"Remover"})]})]}):e.jsxs("div",{className:"text-center p-4",children:[e.jsx(ie,{className:"mx-auto h-6 w-6 text-gray-400"}),e.jsx("p",{className:"mt-1 text-xs font-medium text-gray-500",children:"Banco de Imagens"})]})}),e.jsx(h,{message:x.image_url,className:"mt-2"})]}),e.jsx(J,{open:P,onClose:()=>m(!1),onSelect:t=>{l("image_url",t.url),m(!1)},currentUrl:s.image_url}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 mt-6 border-t border-gray-100 dark:border-white/5",children:[e.jsx(H,{onClick:()=>r(!1),className:"py-3 rounded-xl",children:"Cancelar"}),e.jsx(X,{disabled:B,className:"bg-[#ff3d03] hover:bg-[#e63700] py-3 rounded-xl shadow-lg shadow-[#ff3d03]/20 border-transparent",children:i?"Salvar Alterações":"Criar Categoria"})]})]})]})})]})}export{Te as default};
