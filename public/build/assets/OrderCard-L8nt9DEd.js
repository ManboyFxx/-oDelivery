import{r as i,h as q,j as e,d as m,X as z,a as d,T as W}from"./app-Y5Ta3CeG.js";import{C as f}from"./circle-alert-BNKjWv-2.js";import{U as y}from"./user-DoNN34Dg.js";import{M as X}from"./message-circle-CgJL6sQ5.js";import{M as F}from"./map-pin-CuSUxZDA.js";import{C as G}from"./credit-card-NqdS9wLC.js";import{B as w}from"./bike-sTuLqik4.js";import{S as H}from"./square-pen-BeVpnPXj.js";import{P as J}from"./printer-5ghj988A.js";import{C as K}from"./check-JKkU2n96.js";import{C as v}from"./clock-jhxT_zXH.js";import{T as Q}from"./timer-f9sxEZSM.js";function de({order:t,motoboys:x,onAction:n}){const[k,j]=i.useState(""),[N,_]=i.useState(t.motoboy?.id||""),[C,S]=i.useState(t.payments?.[0]?.method||"cash"),{success:c,info:M}=q();i.useEffect(()=>{const a=()=>{const s=new Date(t.created_at).getTime(),g=new Date().getTime()-s,p=Math.floor(g/(1e3*60*60)),O=Math.floor(g%(1e3*60*60)/(1e3*60)),U=Math.floor(g%(1e3*60)/1e3);j(`${p>0?p+":":""}${O.toString().padStart(2,"0")}:${U.toString().padStart(2,"0")}`)},r=setInterval(a,1e3);return a(),()=>clearInterval(r)},[t.created_at]);const P=a=>{if(!a)return;const r=x.find(s=>s.id===a);d.post(route("orders.assign-motoboy",t.id),{motoboy_id:a},{onSuccess:()=>{c("Motoboy AtribuÃ­do",`${r?.name||"Motoboy"} foi atribuÃ­do ao pedido #${t.order_number}`)}})},T=a=>{S(a);const r=b.find(s=>s.value===a)?.label||a;d.post(route("orders.payment",t.id),{payment_method:a},{onSuccess:()=>{M("Pagamento Atualizado",`MÃ©todo alterado para ${r}`)}})},l=a=>{const r={preparing:"Em Preparo",ready:"Pronto",waiting_motoboy:"Aguardando Motoboy",motoboy_accepted:"Saiu para Entrega",out_for_delivery:"Saiu para Entrega",delivered:"Entregue"};d.post(route("orders.status",t.id),{status:a},{onSuccess:()=>{c("Status Atualizado",`Pedido #${t.order_number} agora estÃ¡: ${r[a]||a}`)}})},E=()=>{d.post(route("orders.start-preparation",t.id),{},{onSuccess:()=>{c("Preparo Iniciado!",`Pedido #${t.order_number} estÃ¡ sendo preparado.`)}})},A=()=>n("print",t),u=()=>n("edit",t),$=()=>n("payment",t),I=()=>n("whatsapp",t),R=()=>n("cancel",t),o=a=>{switch(a){case"delivery":return{label:"Entrega",color:"bg-orange-100 text-orange-700 ring-1 ring-orange-500/20",icon:w};case"pickup":return{label:"Retirada",color:"bg-blue-100 text-blue-700 ring-1 ring-blue-500/20",icon:v};case"table":return{label:"Mesa",color:"bg-purple-100 text-purple-700 ring-1 ring-purple-500/20",icon:y};default:return{label:a,color:"bg-gray-100 text-gray-700 ring-1 ring-gray-500/20",icon:K}}},B=()=>{if(!t.time_status)return"text-gray-500";switch(t.time_status){case"late":return"text-red-500 animate-pulse";case"warning":return"text-yellow-500";case"on_time":return"text-green-500";default:return"text-gray-500"}},D=()=>{if(!t.time_status)return v;switch(t.time_status){case"late":return f;case"warning":return W;default:return Q}},b=[{value:"cash",label:"Dinheiro"},{value:"credit_card",label:"CrÃ©dito"},{value:"debit_card",label:"DÃ©bito"},{value:"pix",label:"PIX"}],L=new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t.total);return e.jsxs("div",{className:"group relative flex flex-col w-full bg-white dark:bg-[#1a1b1e] rounded-[20px] p-4 shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-100 dark:border-white/5",children:[e.jsx("div",{className:m("absolute top-6 left-0 w-1 h-8 rounded-r-full",t.payment_status==="paid"?"bg-green-500":"bg-orange-500")}),e.jsxs("div",{className:"mb-3 flex items-start justify-between pl-2",children:[e.jsx("div",{className:"flex flex-col gap-0.5",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-black text-gray-900 dark:text-white tracking-tight",children:["#",t.order_number]}),o(t.mode)&&e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-bold uppercase tracking-wide ${o(t.mode)?.color}`,children:[(()=>{const a=o(t.mode)?.icon;return a&&e.jsx(a,{className:"h-3 w-3"})})(),o(t.mode)?.label]}),t.is_late&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-bold uppercase tracking-wide bg-red-100 text-red-700 ring-1 ring-red-500/20 animate-pulse",children:[e.jsx(f,{className:"h-3 w-3"}),"ATRASADO"]})]})}),e.jsx("div",{className:"flex items-center gap-1.5",children:e.jsxs("div",{className:m("flex items-center gap-1 px-2 py-1 rounded-lg border text-xs font-bold",t.time_status==="late"?"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800 text-red-600":t.time_status==="warning"?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800 text-yellow-600":"bg-gray-50 dark:bg-white/5 border-gray-100 dark:border-white/5 text-gray-600 dark:text-gray-400"),children:[(()=>{const a=D();return e.jsx(a,{className:m("w-3 h-3",B())})})(),e.jsx("span",{className:"tabular-nums tracking-wide",children:k})]})})]}),e.jsx("div",{className:"mb-3 p-3 bg-gray-50 dark:bg-black/20 rounded-xl border border-gray-100 dark:border-white/5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 flex-shrink-0 rounded-lg bg-white dark:bg-[#1a1b1e] text-orange-500 flex items-center justify-center border border-gray-100 dark:border-white/5 shadow-sm",children:e.jsx(y,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 dark:text-white truncate pr-2",children:t.customer_name}),e.jsx("button",{onClick:I,className:"text-green-600 hover:text-green-700 dark:text-green-500 dark:hover:text-green-400",title:"Abrir WhatsApp",children:e.jsx(X,{className:"w-4 h-4"})})]}),t.address&&e.jsxs("p",{className:"text-[11px] font-medium text-gray-500 dark:text-gray-400 mt-0.5 truncate flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3 flex-shrink-0 opacity-70"}),e.jsxs("span",{className:"truncate",children:[t.address.street,", ",t.address.number]})]})]})]})}),e.jsxs("div",{className:"flex-1 space-y-2 mb-3 px-1",children:[t.items.slice(0,6).map((a,r)=>e.jsxs("div",{className:"flex gap-2 group/item",children:[e.jsxs("span",{className:"flex h-5 w-5 flex-shrink-0 items-center justify-center rounded bg-orange-50 dark:bg-orange-500/10 text-[10px] font-black text-orange-600 dark:text-orange-500",children:[a.quantity,"Ã—"]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("span",{className:"block font-bold text-gray-900 dark:text-white text-xs leading-tight group-hover/item:text-orange-500 transition-colors",children:a.product_name}),a.complements&&a.complements.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.complements.map((s,h)=>e.jsxs("span",{className:"text-[10px] font-medium text-gray-500 dark:text-gray-400 leading-tight",children:["+ ",s.name]},h))}),a.notes&&e.jsxs("p",{className:"text-[10px] font-medium text-red-500 mt-0.5 bg-red-50 dark:bg-red-900/10 px-1.5 py-0.5 rounded inline-block",children:["Obs: ",a.notes]})]})]},r)),t.items.length>6&&e.jsxs("button",{onClick:u,className:"w-full py-1 text-[11px] font-bold text-gray-400 hover:text-orange-500 transition-colors border-t border-gray-100 dark:border-white/5 border-dashed",children:["+ ",t.items.length-6," itens"]})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsx("select",{value:C,onChange:a=>T(a.target.value),className:"flex-1 py-1.5 px-2 rounded-lg border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-black/20 text-xs font-medium focus:ring-orange-500 focus:border-orange-500",children:b.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))})]}),t.mode==="delivery"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),e.jsxs("select",{value:N,onChange:a=>{_(a.target.value),P(a.target.value)},className:"flex-1 py-1.5 px-2 rounded-lg border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-black/20 text-xs font-medium focus:ring-orange-500 focus:border-orange-500",children:[e.jsx("option",{value:"",children:"Atribuir motoboy..."}),x.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t border-gray-100 dark:border-white/5 flex items-center justify-between gap-2",children:[e.jsxs("div",{className:"flex flex-col cursor-pointer hover:opacity-80 transition-opacity",onClick:$,children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest",children:"Total"}),e.jsx("span",{className:"text-base font-black text-gray-900 dark:text-white tracking-tight",children:L})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:u,className:"h-8 w-8 flex items-center justify-center rounded-lg bg-gray-50 dark:bg-white/5 text-gray-600 dark:text-gray-300 hover:bg-orange-50 hover:text-orange-600 dark:hover:bg-orange-500/20 dark:hover:text-orange-500 transition-all active:scale-95",title:"Editar",children:e.jsx(H,{className:"h-4 w-4"})}),e.jsx("button",{onClick:A,className:"h-8 w-8 flex items-center justify-center rounded-lg bg-gray-900 dark:bg-white text-white dark:text-gray-900 hover:bg-orange-600 dark:hover:bg-gray-200 transition-all shadow-sm active:scale-95",title:"Imprimir",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx("button",{onClick:R,className:"h-8 w-8 flex items-center justify-center rounded-lg bg-red-50 dark:bg-red-500/10 text-red-500 hover:bg-red-100 dark:hover:bg-red-500/20 transition-all active:scale-95",title:"Cancelar",children:e.jsx(z,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-white/5",children:[t.status==="new"&&e.jsx("button",{onClick:E,className:"w-full py-2 rounded-xl bg-green-500 hover:bg-green-600 text-white text-sm font-bold shadow-md shadow-green-500/20 transition-all active:scale-95",children:"âœ“ Aceitar e Iniciar Preparo"}),t.status==="preparing"&&e.jsx("button",{onClick:()=>l(t.mode==="delivery"?"waiting_motoboy":"ready"),className:"w-full py-2 rounded-xl bg-orange-500 hover:bg-orange-600 text-white text-sm font-bold shadow-md shadow-orange-500/20 transition-all active:scale-95",children:"âœ“ Marcar como Pronto"}),t.status==="waiting_motoboy"&&t.motoboy&&e.jsx("button",{onClick:()=>l("motoboy_accepted"),className:"w-full py-2 rounded-xl bg-indigo-500 hover:bg-indigo-600 text-white text-sm font-bold shadow-md shadow-indigo-500/20 transition-all active:scale-95",children:"ðŸš´ Motoboy Saiu para Entrega"}),(t.status==="motoboy_accepted"||t.status==="out_for_delivery")&&e.jsx("button",{onClick:()=>l("delivered"),className:"w-full py-2 rounded-xl bg-green-500 hover:bg-green-600 text-white text-sm font-bold shadow-md shadow-green-500/20 transition-all active:scale-95",children:"âœ“ Pedido Entregue"}),t.status==="ready"&&e.jsx("button",{onClick:()=>l("delivered"),className:"w-full py-2 rounded-xl bg-green-500 hover:bg-green-600 text-white text-sm font-bold shadow-md shadow-green-500/20 transition-all active:scale-95",children:"âœ“ Cliente Retirou"})]})]})}export{de as default};
